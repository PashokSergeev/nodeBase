<html lang="ru"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Å–µ—Ç–∫–∞ - –ù–∞—Å—Ç–æ–ª—å–Ω—ã–π —Ç–µ–Ω–Ω–∏—Å</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@600&display=swap" rel="stylesheet"><link href="https://fonts.googleapis.com/css2?family=Oswald:wght@600&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: "Oswald", sans-serif;
            font-optical-sizing: auto;
            font-weight: 600;
            font-style: normal;
            scroll-behavior: smooth;
            color: #1a202c; /* Dark text for light background */
        }
        body::-webkit-scrollbar , .tournament-bracket::-webkit-scrollbar{
            width: 0;
        }
        .racket-bg {
            position: fixed;
            width: 100%;
            height: 100%;
            background-image: url("/images/bg-image.png");
            background-repeat: repeat;
            background-position: center;
            z-index: -1;
            opacity: 0.15;
            transform: rotate(-10deg);
        }

        .tournament-header {
            background: linear-gradient(90deg, #002F6C 0%, #C8102E 100%);
            /*background: linear-gradient(90deg, #003366 0%, #FFFFFF 100%);*/
            /*background: linear-gradient(90deg, #1A1F71 0%, #808080 100%);*/
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            min-height: 150px;
        }
        .logo-container {
            width: 350px;
            padding: 10px;
            height: auto;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .logo-img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .tournament-bracket {
            display: flex;
            overflow-x: auto;
            padding: 70px 0 20px;
            position: relative;
        }

        .round {
            display: flex;
            flex-direction: column;
            min-width: 250px;
            margin-right: 120px;
            position: relative;
        }
        .round h3{
            color: white;
            font-weight: bold;
            font-size: 35px;
        }

        .match {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin: 10px 0;
            position: relative;
            transition: all 0.3s ease;
            z-index: 2;
        }

        .match:hover {
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
        }

        .player {
            padding: 12px;
            border-bottom: 1px solid #eaeaea;
            display: flex;
            align-items: center;
            position: relative;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .player:last-child {
            border-bottom: none;
        }

        .player-name {
            flex-grow: 1;
            margin-left: 10px;
        }

        .player-score {
            font-weight: bold;
            min-width: 30px;
            text-align: center;
        }

        .match-info {
            font-size: 0.8rem;
            color: #666;
            padding: 8px 12px;
            background-color: #f9f9f9;
            border-top: 1px solid #eaeaea;
            border-radius: 0 0 8px 8px;
        }

        .winner {
            background: linear-gradient(-177deg, #002F6C 0%, #C8102E 100%);
            color: white;font-weight: bold;
        }

        .connector-wrapper {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .connector {
            position: absolute;
            border: 2px solid #065ed8;
            z-index: 1;
            transition: border-color 0.3s ease;
        }

        .connector-horizontal {
            height: 2px;
        }

        .connector-vertical {
            width: 2px;
        }

        .connector.highlight {
            border-color: #002F6C;
            border-width: 3px;
            z-index: 10;
        }

        .flag-icon {
            width: 24px;
            height: 16px;
            margin-right: 8px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .admin-controls {
            display: flex;
            justify-content: space-between;
            padding: 8px;
            background-color: #f0f8ff;
            border-radius: 8px 8px 0 0;
        }

        input[type="text"], select {
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        .mode-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
        }

        .progress-indicator {
            height: 6px;
            background: linear-gradient(-177deg, #002F6C 0%, #C8102E 100%);
            position: absolute;
            bottom: 0;
            left: 0;
            border-radius: 0 0 8px 8px;
        }

        .tournament-tabs {
            display: flex;
            overflow-x: auto;
            padding: 10px 0;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }

        .tournament-tab {
            padding: 8px 16px;
            margin-right: 8px;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s ease;
            position: relative;
            color: white;
        }

        .tournament-tab.active {
            background-color: #002F6C;
            font-weight: bold;
        }

        .tournament-tab:hover:not(.active) {
            background-color: #e2e8f0;
            color: #002F6C;
        }

        .tab-actions {
            display: none;
            position: absolute;
            top: -10px;
            right: -10px;
            background-color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            text-align: center;
            line-height: 24px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            cursor: pointer;
        }

        .tournament-tab:hover .tab-actions {
            display: block;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π —Å–µ—Ç–∫–∏ (—Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ) */
        .classic-bracket .round {
            justify-content: space-around;
        }

        .classic-bracket .round:nth-child(1) .match {
            margin: 5px 0;
        }

        .classic-bracket .round:nth-child(2) .match {
            margin: 20px 0;
        }

        .classic-bracket .round:nth-child(3) .match {
            margin: 50px 0;
        }

        .classic-bracket .round:nth-child(4) .match {
            margin: 110px 0;
        }

        .classic-bracket .round:nth-child(5) .match {
            margin: 230px 0;
        }

        .classic-bracket .round:nth-child(6) .match {
            margin: 470px 0;
        }

        .classic-bracket .round:nth-child(7) .match {
            margin: 950px 0;
        }

        /* –ê–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —Ä–µ–∂–∏–º–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ */
        .viewer-controls {
            transition: opacity 0.3s ease;
        }

        .viewer-controls.hidden {
            opacity: 0;
            pointer-events: none;
        }

        /* –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –¥–ª—è –≤–∫–ª–∞–¥–æ–∫ */
        .tab-context-menu {
            position: absolute;
            background-color: white;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            padding: 8px 0;
            z-index: 1000;
            min-width: 150px;
        }

        .tab-context-menu-item {
            padding: 8px 16px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .tab-context-menu-item:hover {
            background-color: #f0f4f8;
        }

        .tab-context-menu-item.danger {
            color: #e53e3e;
        }

        /* –í—Å–ø–ª—ã–≤–∞—é—â–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ –¥–ª—è –∏–≥—Ä–æ–∫–∞ */
        .player-tooltip {
            position: absolute;
            top: -120px;
            left: 0;
            background-color: white;
            color: #002F6C;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            padding: 12px;
            width: 280px;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            pointer-events: none;
        }

        .player:hover .player-tooltip {
            opacity: 1;
            visibility: visible;
        }

        .tooltip-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid #eaeaea;
        }

        .tooltip-name {
            font-weight: bold;
            margin-left: 8px;
            flex-grow: 1;
        }

        .tooltip-score {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .tooltip-sets {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .tooltip-set {
            background-color: #f0f4f8;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85rem;
        }

        .tooltip-info {
            margin-top: 8px;
            font-size: 0.85rem;
            color: #666;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–∞ */
        @keyframes scrollAnimation {
            0% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0); }
        }

        .scroll-animation {
            animation: scrollAnimation 15s ease-in-out infinite;
        }

        @media (max-width: 768px) {
            .tournament-bracket {
                flex-direction: column;
                overflow-x: hidden;
                overflow-y: auto;
            }

            .round {
                width: 100%;
                margin-right: 0;
                margin-bottom: 20px;
            }

            .connector-wrapper {
                display: none;
            }

            .player-tooltip {
                width: 90%;
                left: 5%;
                top: -100px;
            }
        }
    </style>
    <style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.16 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.fixed{position:fixed}.relative{position:relative}.inset-0{inset:0px}.z-50{z-index:50}.mx-2{margin-left:0.5rem;margin-right:0.5rem}.mx-auto{margin-left:auto;margin-right:auto}.mb-2{margin-bottom:0.5rem}.mb-4{margin-bottom:1rem}.mb-8{margin-bottom:2rem}.mr-2{margin-right:0.5rem}.mt-4{margin-top:1rem}.mt-6{margin-top:1.5rem}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.min-h-screen{min-height:100vh}.w-1\/3{width:33.333333%}.w-2\/3{width:66.666667%}.w-full{width:100%}.max-w-md{max-width:28rem}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-6{gap:1.5rem}.overflow-hidden{overflow:hidden}.rounded-lg{border-radius:0.5rem}.rounded-md{border-radius:0.375rem}.border{border-width:1px}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-blue-600{--tw-bg-opacity:1;background-color:rgb(37 99 235 / var(--tw-bg-opacity, 1))}.bg-gray-500{--tw-bg-opacity:1;background-color:rgb(107 114 128 / var(--tw-bg-opacity, 1))}.bg-gray-600{--tw-bg-opacity:1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-opacity-50{--tw-bg-opacity:0.5}.p-2{padding:0.5rem}.p-6{padding:1.5rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-8{padding-top:2rem;padding-bottom:2rem}.text-center{text-align:center}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.font-semibold{font-weight:600}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.shadow{--tw-shadow:0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color), 0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition-all{transition-property:all;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.hover\:bg-blue-700:hover{--tw-bg-opacity:1;background-color:rgb(29 78 216 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-600:hover{--tw-bg-opacity:1;background-color:rgb(75 85 99 / var(--tw-bg-opacity, 1))}.hover\:bg-gray-700:hover{--tw-bg-opacity:1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.hover\:bg-green-700:hover{--tw-bg-opacity:1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}@media (min-width: 768px){.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}</style></head>
<body class="min-h-screen" style=" background: linear-gradient(135deg, rgba(15, 23, 42, 0.95) 0%, rgba(30, 41, 59, 0.95) 100%);">
<!-- Background elements -->
<div class="racket-bg"></div>

<div class="container mx-auto px-4 py-8">
<!--    <header class="tournament-header text-white shadow-lg">-->
<!--        <div class="container mx-auto py-8 flex justify-between items-center gap-16">-->
<!--            <div class="logo-container">-->
<!--                <img id="leftLogo" class="logo-img" src="images/ttfr_logo_new_03.png" alt="Left Logo">-->
<!--            </div>-->
<!--            <h1 id="tournamentTitle" class="text-3xl font-bold text-center ">–¢—É—Ä–Ω–∏—Ä –ø–æ –Ω–∞—Å—Ç–æ–ª—å–Ω–æ–º—É —Ç–µ–Ω–Ω–∏—Å—É</h1>-->
<!--            <div class="logo-container">-->
<!--                <img id="rightLogo" class="logo-img" src="images/slntr.png" alt="Right Logo">-->
<!--            </div>-->
<!--        </div>-->
<!--    </header>-->

    <div class="mode-toggle viewer-controls">
        <button id="toggleMode" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg shadow-lg transition-all">
            –†–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
        </button>
    </div>

    <div id="adminPanel" class="mb-8 bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-xl font-semibold mb-4">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç—É—Ä–Ω–∏—Ä–∞</h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label class="block text-gray-700 mb-2">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞:</label>
                <input type="text" id="tournamentName" class="w-full p-2 border border-gray-300 rounded-md" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞" value="–¢—É—Ä–Ω–∏—Ä –ø–æ –Ω–∞—Å—Ç–æ–ª—å–Ω–æ–º—É —Ç–µ–Ω–Ω–∏—Å—É">
            </div>

            <div>
                <label class="block text-gray-700 mb-2">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤:</label>
                <select id="playerCount" class="w-full p-2 border border-gray-300 rounded-md">
                    <option value="4">4 —É—á–∞—Å—Ç–Ω–∏–∫–∞</option>
                    <option value="8">8 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</option>
                    <option value="16" >16 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</option>
                    <option value="32" selected="">32 —É—á–∞—Å—Ç–Ω–∏–∫–∞</option>
                    <option value="64">64 —É—á–∞—Å—Ç–Ω–∏–∫–∞</option>
                    <option value="128">128 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</option>
                </select>
            </div>
        </div>

        <div class="mt-6 flex justify-between">
            <button id="createTournament" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg shadow transition-all">
                –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç—É—Ä–Ω–∏—Ä
            </button>

            <div>
                <button id="saveTournament" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg shadow transition-all mr-2">
                    –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                </button>
                <button id="loadTournament" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-6 rounded-lg shadow transition-all">
                    –ó–∞–≥—Ä—É–∑–∏—Ç—å
                </button>
            </div>
        </div>
    </div>

    <div id="viewerControls" class="mb-8 bg-white p-6 rounded-lg shadow-md viewer-controls" style="display: none;">
        <h2 class="text-xl font-semibold mb-4">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞</h2>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label class="block text-gray-700 mb-2">–ü–æ–∫–∞–∑–∞—Ç—å —Ä–∞—É–Ω–¥—ã:</label>
                <div class="flex items-center">
                    <span class="mr-2">–û—Ç:</span>
                    <select id="startRound" class="w-full p-2 border border-gray-300 rounded-md" size="8">
                        <option value="0">1/128 —Ñ–∏–Ω–∞–ª–∞</option>
                        <option value="1">1/64 —Ñ–∏–Ω–∞–ª–∞</option>
                        <option value="2">1/32 —Ñ–∏–Ω–∞–ª–∞</option>
                        <option value="3">1/16 —Ñ–∏–Ω–∞–ª–∞</option>
                        <option value="4" >1/8 —Ñ–∏–Ω–∞–ª–∞</option>
                        <option value="5" >1/4 —Ñ–∏–Ω–∞–ª–∞</option>
                        <option value="6" >1/2 —Ñ–∏–Ω–∞–ª–∞</option>
                        <option value="7" >–§–∏–Ω–∞–ª</option>
                    </select>

                    <span class="mx-2">–î–æ:</span>
                    <select id="endRound" class="w-full p-2 border border-gray-300 rounded-md" size="8">
                        <option value="0">1/128 —Ñ–∏–Ω–∞–ª–∞</option>
                        <option value="1">1/64 —Ñ–∏–Ω–∞–ª–∞</option>
                        <option value="2">1/32 —Ñ–∏–Ω–∞–ª–∞</option>
                        <option value="3">1/16 —Ñ–∏–Ω–∞–ª–∞</option>
                        <option value="4" >1/8 —Ñ–∏–Ω–∞–ª–∞</option>
                        <option value="5" >1/4 —Ñ–∏–Ω–∞–ª–∞</option>
                        <option value="6" >1/2 —Ñ–∏–Ω–∞–ª–∞</option>
                        <option value="7" selected="" >–§–∏–Ω–∞–ª</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="mt-4">
            <button id="applyViewSettings" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg shadow transition-all">
                –ü—Ä–∏–º–µ–Ω–∏—Ç—å
            </button>
        </div>
    </div>

    <div id="tournamentTabs" class="tournament-tabs viewer-controls"><div class="tournament-tab active">–ß–µ–º–ø–∏–æ–Ω–∞—Ç –≥–æ—Ä–æ–¥–∞<div class="tab-actions">‚ãÆ</div></div><div class="tournament-tab ">–ö—É–±–æ–∫ –æ–±–ª–∞—Å—Ç–∏<div class="tab-actions">‚ãÆ</div></div><div class="tournament-tab">+ –ù–æ–≤—ã–π —Ç—É—Ä–Ω–∏—Ä</div></div>

    <div id="tournamentContainer" class="relative overflow-hidden">
        <div id="tournamentBracket" class="tournament-bracket classic-bracket">
<!--            <div class="round"><h3 class="text-center font-bold mb-4">1/8 —Ñ–∏–Ω–∞–ª–∞</h3>-->
<!--                <div class="match" data-round="3" data-match="0">-->
<!--                    <div class="player winner" data-player-name="–ò–≤–∞–Ω–æ–≤ –ê." data-round="3" data-match="0"-->
<!--                         data-player-index="0">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-kr"></span><span-->
<!--                                    class="tooltip-name">–ò–≤–∞–Ω–æ–≤ –ê.</span><span class="tooltip-score">3:0</span></div>-->
<!--                            <div class="tooltip-sets">-->
<!--                                <div class="tooltip-set">11-1</div>-->
<!--                                <div class="tooltip-set">11-4</div>-->
<!--                                <div class="tooltip-set">11-5</div>-->
<!--                            </div>-->
<!--                            <div class="tooltip-info">üìÖ 15.06.2023 10:00 üèì –°—Ç–æ–ª 1 üìù 1/16 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-kr"></span><span class="player-name">–ò–≤–∞–Ω–æ–≤ –ê.</span><span-->
<!--                            class="player-score">3</span></div>-->
<!--                    <div class="player " data-player-name="–ü–µ—Ç—Ä–æ–≤ –°." data-round="3" data-match="0"-->
<!--                         data-player-index="1">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-jp"></span><span-->
<!--                                    class="tooltip-name">–ü–µ—Ç—Ä–æ–≤ –°.</span><span class="tooltip-score">3:0</span></div>-->
<!--                            <div class="tooltip-sets">-->
<!--                                <div class="tooltip-set">11-1</div>-->
<!--                                <div class="tooltip-set">11-4</div>-->
<!--                                <div class="tooltip-set">11-5</div>-->
<!--                            </div>-->
<!--                            <div class="tooltip-info">üìÖ 15.06.2023 10:00 üèì –°—Ç–æ–ª 1 üìù 1/16 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-jp"></span><span class="player-name">–ü–µ—Ç—Ä–æ–≤ –°.</span><span-->
<!--                            class="player-score">0</span></div>-->
<!--                    <div class="match-info">üìÖ 15.06.2023 10:00 üèì –°—Ç–æ–ª 1 üìù 1/16 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                    <div class="progress-indicator" style="width: 100%;"></div>-->
<!--                </div>-->
<!--                <div class="match" data-round="3" data-match="1">-->
<!--                    <div class="player winner" data-player-name="–°–∏–¥–æ—Ä–æ–≤ –ò." data-round="3" data-match="1"-->
<!--                         data-player-index="0">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-jp"></span><span-->
<!--                                    class="tooltip-name">–°–∏–¥–æ—Ä–æ–≤ –ò.</span><span class="tooltip-score">3:0</span></div>-->
<!--                            <div class="tooltip-sets">-->
<!--                                <div class="tooltip-set">11-1</div>-->
<!--                                <div class="tooltip-set">11-7</div>-->
<!--                                <div class="tooltip-set">11-7</div>-->
<!--                            </div>-->
<!--                            <div class="tooltip-info">üìÖ 15.06.2023 11:00 üèì –°—Ç–æ–ª 2 üìù 1/16 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-jp"></span><span class="player-name">–°–∏–¥–æ—Ä–æ–≤ –ò.</span><span-->
<!--                            class="player-score">3</span></div>-->
<!--                    <div class="player " data-player-name="–°–º–∏—Ä–Ω–æ–≤ –ö." data-round="3" data-match="1"-->
<!--                         data-player-index="1">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-kr"></span><span-->
<!--                                    class="tooltip-name">–°–º–∏—Ä–Ω–æ–≤ –ö.</span><span class="tooltip-score">3:0</span></div>-->
<!--                            <div class="tooltip-sets">-->
<!--                                <div class="tooltip-set">11-1</div>-->
<!--                                <div class="tooltip-set">11-7</div>-->
<!--                                <div class="tooltip-set">11-7</div>-->
<!--                            </div>-->
<!--                            <div class="tooltip-info">üìÖ 15.06.2023 11:00 üèì –°—Ç–æ–ª 2 üìù 1/16 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-kr"></span><span class="player-name">–°–º–∏—Ä–Ω–æ–≤ –ö.</span><span-->
<!--                            class="player-score">0</span></div>-->
<!--                    <div class="match-info">üìÖ 15.06.2023 11:00 üèì –°—Ç–æ–ª 2 üìù 1/16 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                    <div class="progress-indicator" style="width: 100%;"></div>-->
<!--                </div>-->
<!--                <div class="match" data-round="3" data-match="2">-->
<!--                    <div class="player winner" data-player-name="–ö—É–∑–Ω–µ—Ü–æ–≤ –î." data-round="3" data-match="2"-->
<!--                         data-player-index="0">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-de"></span><span-->
<!--                                    class="tooltip-name">–ö—É–∑–Ω–µ—Ü–æ–≤ –î.</span><span class="tooltip-score">4:0</span></div>-->
<!--                            <div class="tooltip-sets">-->
<!--                                <div class="tooltip-set">11-3</div>-->
<!--                                <div class="tooltip-set">11-7</div>-->
<!--                                <div class="tooltip-set">11-4</div>-->
<!--                                <div class="tooltip-set">11-5</div>-->
<!--                            </div>-->
<!--                            <div class="tooltip-info">üìÖ 15.06.2023 12:00 üèì –°—Ç–æ–ª 3 üìù 1/16 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-de"></span><span class="player-name">–ö—É–∑–Ω–µ—Ü–æ–≤ –î.</span><span-->
<!--                            class="player-score">4</span></div>-->
<!--                    <div class="player winner" data-player-name="–ü–æ–ø–æ–≤ –ú." data-round="3" data-match="2"-->
<!--                         data-player-index="1">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-de"></span><span-->
<!--                                    class="tooltip-name">–ü–æ–ø–æ–≤ –ú.</span><span class="tooltip-score">4:0</span></div>-->
<!--                            <div class="tooltip-sets">-->
<!--                                <div class="tooltip-set">11-3</div>-->
<!--                                <div class="tooltip-set">11-7</div>-->
<!--                                <div class="tooltip-set">11-4</div>-->
<!--                                <div class="tooltip-set">11-5</div>-->
<!--                            </div>-->
<!--                            <div class="tooltip-info">üìÖ 15.06.2023 12:00 üèì –°—Ç–æ–ª 3 üìù 1/16 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-de"></span><span class="player-name">–ü–æ–ø–æ–≤ –ú.</span><span-->
<!--                            class="player-score">0</span></div>-->
<!--                    <div class="match-info">üìÖ 15.06.2023 12:00 üèì –°—Ç–æ–ª 3 üìù 1/16 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                    <div class="progress-indicator" style="width: 100%;"></div>-->
<!--                </div>-->
<!--                <div class="match" data-round="3" data-match="3">-->
<!--                    <div class="player winner" data-player-name="–í–∞—Å–∏–ª—å–µ–≤ –ù." data-round="3" data-match="3"-->
<!--                         data-player-index="0">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-jp"></span><span-->
<!--                                    class="tooltip-name">–í–∞—Å–∏–ª—å–µ–≤ –ù.</span><span class="tooltip-score">4:1</span></div>-->
<!--                            <div class="tooltip-sets">-->
<!--                                <div class="tooltip-set">11-8</div>-->
<!--                                <div class="tooltip-set">11-5</div>-->
<!--                                <div class="tooltip-set">11-6</div>-->
<!--                                <div class="tooltip-set">11-5</div>-->
<!--                                <div class="tooltip-set">9-11</div>-->
<!--                            </div>-->
<!--                            <div class="tooltip-info">üìÖ 15.06.2023 13:00 üèì –°—Ç–æ–ª 4 üìù 1/16 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-jp"></span><span class="player-name">–í–∞—Å–∏–ª—å–µ–≤ –ù.</span><span-->
<!--                            class="player-score">4</span></div>-->
<!--                    <div class="player " data-player-name="–°–æ–∫–æ–ª–æ–≤ –ê." data-round="3" data-match="3"-->
<!--                         data-player-index="1">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-de"></span><span-->
<!--                                    class="tooltip-name">–°–æ–∫–æ–ª–æ–≤ –ê.</span><span class="tooltip-score">4:1</span></div>-->
<!--                            <div class="tooltip-sets">-->
<!--                                <div class="tooltip-set">11-8</div>-->
<!--                                <div class="tooltip-set">11-5</div>-->
<!--                                <div class="tooltip-set">11-6</div>-->
<!--                                <div class="tooltip-set">11-5</div>-->
<!--                                <div class="tooltip-set">9-11</div>-->
<!--                            </div>-->
<!--                            <div class="tooltip-info">üìÖ 15.06.2023 13:00 üèì –°—Ç–æ–ª 4 üìù 1/16 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-de"></span><span class="player-name">–°–æ–∫–æ–ª–æ–≤ –ê.</span><span-->
<!--                            class="player-score">1</span></div>-->
<!--                    <div class="match-info">üìÖ 15.06.2023 13:00 üèì –°—Ç–æ–ª 4 üìù 1/16 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                    <div class="progress-indicator" style="width: 100%;"></div>-->
<!--                </div>-->
<!--                <div class="match" data-round="3" data-match="4">-->
<!--                    <div class="player " data-player-name="–ú–∏—Ö–∞–π–ª–æ–≤ –í." data-round="3" data-match="4"-->
<!--                         data-player-index="0">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-cn"></span><span-->
<!--                                    class="tooltip-name">–ú–∏—Ö–∞–π–ª–æ–≤ –í.</span><span class="tooltip-score"></span></div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-cn"></span><span class="player-name">–ú–∏—Ö–∞–π–ª–æ–≤ –í.</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                    <div class="player " data-player-name="–ù–æ–≤–∏–∫–æ–≤ –ì." data-round="3" data-match="4"-->
<!--                         data-player-index="1">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-kr"></span><span-->
<!--                                    class="tooltip-name">–ù–æ–≤–∏–∫–æ–≤ –ì.</span><span class="tooltip-score"></span></div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-kr"></span><span class="player-name">–ù–æ–≤–∏–∫–æ–≤ –ì.</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                </div>-->
<!--                <div class="match" data-round="3" data-match="5">-->
<!--                    <div class="player " data-player-name="–§–µ–¥–æ—Ä–æ–≤ –ï." data-round="3" data-match="5"-->
<!--                         data-player-index="0">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-kz"></span><span-->
<!--                                    class="tooltip-name">–§–µ–¥–æ—Ä–æ–≤ –ï.</span><span class="tooltip-score"></span></div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-kz"></span><span class="player-name">–§–µ–¥–æ—Ä–æ–≤ –ï.</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                    <div class="player " data-player-name="–ú–æ—Ä–æ–∑–æ–≤ –õ." data-round="3" data-match="5"-->
<!--                         data-player-index="1">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-ua"></span><span-->
<!--                                    class="tooltip-name">–ú–æ—Ä–æ–∑–æ–≤ –õ.</span><span class="tooltip-score"></span></div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-ua"></span><span class="player-name">–ú–æ—Ä–æ–∑–æ–≤ –õ.</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                </div>-->
<!--                <div class="match" data-round="3" data-match="6">-->
<!--                    <div class="player " data-player-name="–í–æ–ª–∫–æ–≤ –ü." data-round="3" data-match="6"-->
<!--                         data-player-index="0">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-de"></span><span-->
<!--                                    class="tooltip-name">–í–æ–ª–∫–æ–≤ –ü.</span><span class="tooltip-score"></span></div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-de"></span><span class="player-name">–í–æ–ª–∫–æ–≤ –ü.</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                    <div class="player " data-player-name="–ê–ª–µ–∫—Å–µ–µ–≤ –†." data-round="3" data-match="6"-->
<!--                         data-player-index="1">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-kz"></span><span-->
<!--                                    class="tooltip-name">–ê–ª–µ–∫—Å–µ–µ–≤ –†.</span><span class="tooltip-score"></span></div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-kz"></span><span class="player-name">–ê–ª–µ–∫—Å–µ–µ–≤ –†.</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                </div>-->
<!--                <div class="match" data-round="3" data-match="7">-->
<!--                    <div class="player " data-player-name="–õ–µ–±–µ–¥–µ–≤ –¢." data-round="3" data-match="7"-->
<!--                         data-player-index="0">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-kr"></span><span-->
<!--                                    class="tooltip-name">–õ–µ–±–µ–¥–µ–≤ –¢.</span><span class="tooltip-score"></span></div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-kr"></span><span class="player-name">–õ–µ–±–µ–¥–µ–≤ –¢.</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                    <div class="player " data-player-name="–°–µ–º–µ–Ω–æ–≤ –Æ." data-round="3" data-match="7"-->
<!--                         data-player-index="1">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-by"></span><span-->
<!--                                    class="tooltip-name">–°–µ–º–µ–Ω–æ–≤ –Æ.</span><span class="tooltip-score"></span></div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-by"></span><span class="player-name">–°–µ–º–µ–Ω–æ–≤ –Æ.</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="round"><h3 class="text-center font-bold mb-4">1/4 —Ñ–∏–Ω–∞–ª–∞</h3>-->
<!--                <div class="match" data-round="2" data-match="0">-->
<!--                    <div class="player winner" data-player-name="–ò–≤–∞–Ω–æ–≤ –ê." data-round="2" data-match="0"-->
<!--                         data-player-index="0">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-kr"></span><span-->
<!--                                    class="tooltip-name">–ò–≤–∞–Ω–æ–≤ –ê.</span><span class="tooltip-score">3:2</span></div>-->
<!--                            <div class="tooltip-sets">-->
<!--                                <div class="tooltip-set">11-8</div>-->
<!--                                <div class="tooltip-set">11-8</div>-->
<!--                                <div class="tooltip-set">11-6</div>-->
<!--                                <div class="tooltip-set">1-11</div>-->
<!--                                <div class="tooltip-set">6-11</div>-->
<!--                            </div>-->
<!--                            <div class="tooltip-info">üìÖ 16.06.2023 10:00 üèì –°—Ç–æ–ª 1 üìù 1/8 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-kr"></span><span class="player-name">–ò–≤–∞–Ω–æ–≤ –ê.</span><span-->
<!--                            class="player-score">3</span></div>-->
<!--                    <div class="player " data-player-name="–°–∏–¥–æ—Ä–æ–≤ –ò." data-round="2" data-match="0"-->
<!--                         data-player-index="1">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-jp"></span><span-->
<!--                                    class="tooltip-name">–°–∏–¥–æ—Ä–æ–≤ –ò.</span><span class="tooltip-score">3:2</span></div>-->
<!--                            <div class="tooltip-sets">-->
<!--                                <div class="tooltip-set">11-8</div>-->
<!--                                <div class="tooltip-set">11-8</div>-->
<!--                                <div class="tooltip-set">11-6</div>-->
<!--                                <div class="tooltip-set">1-11</div>-->
<!--                                <div class="tooltip-set">6-11</div>-->
<!--                            </div>-->
<!--                            <div class="tooltip-info">üìÖ 16.06.2023 10:00 üèì –°—Ç–æ–ª 1 üìù 1/8 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-jp"></span><span class="player-name">–°–∏–¥–æ—Ä–æ–≤ –ò.</span><span-->
<!--                            class="player-score">2</span></div>-->
<!--                    <div class="match-info">üìÖ 16.06.2023 10:00 üèì –°—Ç–æ–ª 1 üìù 1/8 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                    <div class="progress-indicator" style="width: 100%;"></div>-->
<!--                </div>-->
<!--                <div class="match" data-round="2" data-match="1">-->
<!--                    <div class="player winner" data-player-name="–ö—É–∑–Ω–µ—Ü–æ–≤ –î." data-round="2" data-match="1"-->
<!--                         data-player-index="0">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-de"></span><span-->
<!--                                    class="tooltip-name">–ö—É–∑–Ω–µ—Ü–æ–≤ –î.</span><span class="tooltip-score">3:2</span></div>-->
<!--                            <div class="tooltip-sets">-->
<!--                                <div class="tooltip-set">11-1</div>-->
<!--                                <div class="tooltip-set">11-4</div>-->
<!--                                <div class="tooltip-set">11-9</div>-->
<!--                                <div class="tooltip-set">1-11</div>-->
<!--                                <div class="tooltip-set">4-11</div>-->
<!--                            </div>-->
<!--                            <div class="tooltip-info">üìÖ 16.06.2023 11:00 üèì –°—Ç–æ–ª 2 üìù 1/8 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-de"></span><span class="player-name">–ö—É–∑–Ω–µ—Ü–æ–≤ –î.</span><span-->
<!--                            class="player-score">3</span></div>-->
<!--                    <div class="player " data-player-name="–í–∞—Å–∏–ª—å–µ–≤ –ù." data-round="2" data-match="1"-->
<!--                         data-player-index="1">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-jp"></span><span-->
<!--                                    class="tooltip-name">–í–∞—Å–∏–ª—å–µ–≤ –ù.</span><span class="tooltip-score">3:2</span></div>-->
<!--                            <div class="tooltip-sets">-->
<!--                                <div class="tooltip-set">11-1</div>-->
<!--                                <div class="tooltip-set">11-4</div>-->
<!--                                <div class="tooltip-set">11-9</div>-->
<!--                                <div class="tooltip-set">1-11</div>-->
<!--                                <div class="tooltip-set">4-11</div>-->
<!--                            </div>-->
<!--                            <div class="tooltip-info">üìÖ 16.06.2023 11:00 üèì –°—Ç–æ–ª 2 üìù 1/8 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-jp"></span><span class="player-name">–í–∞—Å–∏–ª—å–µ–≤ –ù.</span><span-->
<!--                            class="player-score">2</span></div>-->
<!--                    <div class="match-info">üìÖ 16.06.2023 11:00 üèì –°—Ç–æ–ª 2 üìù 1/8 —Ñ–∏–Ω–∞–ª–∞</div>-->
<!--                    <div class="progress-indicator" style="width: 100%;"></div>-->
<!--                </div>-->
<!--                <div class="match" data-round="2" data-match="2">-->
<!--                    <div class="player " data-player-name="" data-round="2" data-match="2" data-player-index="0"><span-->
<!--                            class="flag-icon flag-icon-ru"></span><span class="player-name">‚Äî</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                    <div class="player " data-player-name="" data-round="2" data-match="2" data-player-index="1"><span-->
<!--                            class="flag-icon flag-icon-ru"></span><span class="player-name">‚Äî</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                </div>-->
<!--                <div class="match" data-round="2" data-match="3">-->
<!--                    <div class="player " data-player-name="" data-round="2" data-match="3" data-player-index="0"><span-->
<!--                            class="flag-icon flag-icon-ru"></span><span class="player-name">‚Äî</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                    <div class="player " data-player-name="" data-round="2" data-match="3" data-player-index="1"><span-->
<!--                            class="flag-icon flag-icon-ru"></span><span class="player-name">‚Äî</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="round"><h3 class="text-center font-bold mb-4">1/2 —Ñ–∏–Ω–∞–ª–∞</h3>-->
<!--                <div class="match" data-round="1" data-match="0">-->
<!--                    <div class="player winner" data-player-name="–ò–≤–∞–Ω–æ–≤ –ê." data-round="1" data-match="0"-->
<!--                         data-player-index="0">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-kr"></span><span-->
<!--                                    class="tooltip-name">–ò–≤–∞–Ω–æ–≤ –ê.</span><span class="tooltip-score"></span></div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-kr"></span><span class="player-name">–ò–≤–∞–Ω–æ–≤ –ê.</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                    <div class="player winner" data-player-name="–ö—É–∑–Ω–µ—Ü–æ–≤ –î." data-round="1" data-match="0"-->
<!--                         data-player-index="1">-->
<!--                        <div class="player-tooltip">-->
<!--                            <div class="tooltip-header"><span class="flag-icon flag-icon-de"></span><span-->
<!--                                    class="tooltip-name">–ö—É–∑–Ω–µ—Ü–æ–≤ –î.</span><span class="tooltip-score"></span></div>-->
<!--                        </div>-->
<!--                        <span class="flag-icon flag-icon-de"></span><span class="player-name">–ö—É–∑–Ω–µ—Ü–æ–≤ –î.</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                </div>-->
<!--                <div class="match" data-round="1" data-match="1">-->
<!--                    <div class="player " data-player-name="" data-round="1" data-match="1" data-player-index="0"><span-->
<!--                            class="flag-icon flag-icon-ru"></span><span class="player-name">‚Äî</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                    <div class="player " data-player-name="" data-round="1" data-match="1" data-player-index="1"><span-->
<!--                            class="flag-icon flag-icon-ru"></span><span class="player-name">‚Äî</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="round"><h3 class="text-center font-bold mb-4">–§–∏–Ω–∞–ª</h3>-->
<!--                <div class="match" data-round="0" data-match="0">-->
<!--                    <div class="player " data-player-name="" data-round="0" data-match="0" data-player-index="0"><span-->
<!--                            class="flag-icon flag-icon-ru"></span><span class="player-name">‚Äî</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                    <div class="player " data-player-name="" data-round="0" data-match="0" data-player-index="1"><span-->
<!--                            class="flag-icon flag-icon-ru"></span><span class="player-name">‚Äî</span><span-->
<!--                            class="player-score"></span></div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="connector-wrapper">-->
<!--                <div class="connector connector-horizontal" data-from="undefined-0" data-to="undefined-0"-->
<!--                     style="top: 568.094px; left: 675.5px;"></div>-->
<!--                <div class="connector connector-vertical" data-connects="undefined-0"-->
<!--                     style="top: 568.094px; left: 65.5px; height: 144.188px;"></div>-->
<!--                <div class="connector connector-horizontal" data-from="undefined-1" data-to="undefined-0"-->
<!--                     style="top: 712.281px; left: 675.5px;"></div>-->
<!--                <div class="connector connector-horizontal" data-from="undefined-2" data-to="undefined-1"-->
<!--                     style="top: 856.469px; left: 675.5px;"></div>-->
<!--                <div class="connector connector-vertical" data-connects="undefined-1"-->
<!--                     style="top: 856.469px; left: 65.5px; height: 144.188px;"></div>-->
<!--                <div class="connector connector-horizontal" data-from="undefined-3" data-to="undefined-1"-->
<!--                     style="top: 1000.66px; left: 675.5px;"></div>-->
<!--                <div class="connector connector-horizontal" data-from="undefined-4" data-to="undefined-2"-->
<!--                     style="top: 1126.25px; left: 675.5px;"></div>-->
<!--                <div class="connector connector-vertical" data-connects="undefined-2"-->
<!--                     style="top: 1126.25px; left: 65.5px; height: 107px;"></div>-->
<!--                <div class="connector connector-horizontal" data-from="undefined-5" data-to="undefined-2"-->
<!--                     style="top: 1233.25px; left: 675.5px;"></div>-->
<!--                <div class="connector connector-horizontal" data-from="undefined-6" data-to="undefined-3"-->
<!--                     style="top: 1340.25px; left: 675.5px;"></div>-->
<!--                <div class="connector connector-vertical" data-connects="undefined-3"-->
<!--                     style="top: 1340.25px; left: 65.5px; height: 107px;"></div>-->
<!--                <div class="connector connector-horizontal" data-from="undefined-7" data-to="undefined-3"-->
<!--                     style="top: 1447.25px; left: 675.5px;"></div>-->
<!--                <div class="connector connector-horizontal" data-from="undefined-0" data-to="undefined-0"-->
<!--                     style="top: 1647.84px; left: 675.5px;"></div>-->
<!--                <div class="connector connector-vertical" data-connects="undefined-0"-->
<!--                     style="top: 1647.84px; left: 65.5px; height: 174.188px;"></div>-->
<!--                <div class="connector connector-horizontal" data-from="undefined-1" data-to="undefined-0"-->
<!--                     style="top: 1822.03px; left: 675.5px;"></div>-->
<!--                <div class="connector connector-horizontal" data-from="undefined-2" data-to="undefined-1"-->
<!--                     style="top: 1977.62px; left: 675.5px;"></div>-->
<!--                <div class="connector connector-vertical" data-connects="undefined-1"-->
<!--                     style="top: 1977.62px; left: 65.5px; height: 137px;"></div>-->
<!--                <div class="connector connector-horizontal" data-from="undefined-3" data-to="undefined-1"-->
<!--                     style="top: 2114.62px; left: 675.5px;"></div>-->
<!--                <div class="connector connector-horizontal" data-from="undefined-0" data-to="undefined-0"-->
<!--                     style="top: 2341.62px; left: 675.5px;"></div>-->
<!--                <div class="connector connector-vertical" data-connects="undefined-0"-->
<!--                     style="top: 2341.62px; left: 65.5px; height: 197px;"></div>-->
<!--                <div class="connector connector-horizontal" data-from="undefined-1" data-to="undefined-0"-->
<!--                     style="top: 2538.62px; left: 675.5px;"></div>-->
<!--            </div>-->
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ç—á–∞ -->
<div id="matchModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-lg p-6 w-full max-w-md">
        <h3 class="text-xl font-bold mb-4">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ç—á–∞</h3>

        <div class="mb-4">
            <label class="block text-gray-700 mb-2">–ò–≥—Ä–æ–∫ 1:</label>
            <div class="flex items-center">
                <select id="player1Country" class="w-1/3 p-2 border border-gray-300 rounded-md mr-2">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω</option>
                    <option value="ady">–ê–¥—ã–≥–µ—è</option>
                    <option value="alt">–ê–ª—Ç–∞–π</option>
                    <option value="bash">–ë–∞—à–∫–æ—Ä—Ç–æ—Å—Ç–∞–Ω</option>
                    <option value="bury">–ë—É—Ä—è—Ç–∏—è</option>
                    <option value="dnr">–î–æ–Ω–µ—Ü–∫–∞—è –Ω–∞—Ä–æ–¥–Ω–∞—è —Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –î–ù–†</option>
                    <option value="dag">–î–∞–≥–µ—Å—Ç–∞–Ω</option>
                    <option value="ing">–ò–Ω–≥—É—à–µ—Ç–∏—è</option>
                    <option value="kb">–ö–∞–±–∞—Ä–¥–∏–Ω–æ-–ë–∞–ª–∫–∞—Ä–∏—è</option>
                    <option value="klm">–ö–∞–ª–º—ã–∫–∏—è</option>
                    <option value="kar">–ö–∞—Ä–∞—á–∞–µ–≤–æ-–ß–µ—Ä–∫–µ—Å–∏—è</option>
                    <option value="krl">–ö–∞—Ä–µ–ª–∏—è</option>
                    <option value="kom">–ö–æ–º–∏</option>
                    <option value="cr">–ö—Ä—ã–º</option>
                    <option value="lnr">–õ—É–≥–∞–Ω—Å–∫–∞—è –Ω–∞—Ä–æ–¥–Ω–∞—è —Ä–µ—Å–ø—É–±–ª–∏–∫–∞</option>
                    <option value="mr">–ú–∞—Ä–∏–π –≠–ª</option>
                    <option value="mrd">–ú–æ—Ä–¥–æ–≤–∏—è</option>
                    <option value="sak">–°–∞—Ö–∞ (–Ø–∫—É—Ç–∏—è)</option>
                    <option value="alv">–°–µ–≤–µ—Ä–Ω–∞—è –û—Å–µ—Ç–∏—è ‚Äî –ê–ª–∞–Ω–∏—è</option>
                    <option value="tat">–¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω</option>
                    <option value="tuv">–¢—ã–≤–∞</option>
                    <option value="udm">–£–¥–º—É—Ä—Ç–∏—è</option>
                    <option value="khk">–•–∞–∫–∞—Å–∏—è</option>
                    <option value="che">–ß–µ—á–Ω—è</option>
                    <option value="chv">–ß—É–≤–∞—à–∏—è</option>

                    <option value="altk">–ê–ª—Ç–∞–π—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="zbk">–ó–∞–±–∞–π–∫–∞–ª—å—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="kam">–ö–∞–º—á–∞—Ç—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="kras">–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="krd">–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="per">–ü–µ—Ä–º—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="pri">–ü—Ä–∏–º–æ—Ä—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="sta">–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="hab">–•–∞–±–∞—Ä–æ–≤—Å–∫–∏–π –∫—Ä–∞–π</option>

                    <option value="amur">–ê–º—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="arh">–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="ast">–ê—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="bel">–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="bry">–ë—Ä—è–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="vla">–í–ª–∞–¥–∏–º–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="vlg">–í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="vls">–í–æ–ª–æ–≥–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="vrn">–í–æ—Ä–æ–Ω–µ–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="zpo">–ó–∞–ø–æ—Ä–æ–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="iva">–ò–≤–∞–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="irk">–ò—Ä–∫—É—Ç—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="klg">–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="klz">–ö–∞–ª—É–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="kem">–ö–µ–º–µ—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="kir">–ö–∏—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="kos">–ö–æ—Å—Ç—Ä–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="kur">–ö—É—Ä–≥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="kurs">–ö—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="len">–õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="lip">–õ–∏–ø–µ—Ü–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="mag">–ú–∞–≥–∞–¥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="mos">–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="mur">–ú—É—Ä–º–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="nin">–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="nov">–ù–æ–≤–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="nvs">–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="oms">–û–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="oren">–û—Ä–µ–Ω–±—É—Ä–≥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="orl">–û—Ä–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="pnz">–ü–µ–Ω–∑–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="psk">–ü—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="ros">–†–æ—Å—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="rya">–†—è–∑–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="sam">–°–∞–º–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="sar">–°–∞—Ä–∞—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="sah">–°–∞—Ö–∞–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="sve">–°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="smo">–°–º–æ–ª–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="tam">–¢–∞–º–±–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="tom">–¢–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="tvobl">–¢–≤–µ—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="tul">–¢—É–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="tyu">–¢—é–º–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="uly">–£–ª—å—è–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="xobl">–•–µ—Ä—Å–æ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="cheb">–ß–µ–ª—è–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="yar">–Ø—Ä–æ—Å–ª–∞–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>

                    <option value="msk">–ú–æ—Å–∫–≤–∞</option>
                    <option value="spb">–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</option>
                    <option value="sev">–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å</option>

                    <option value="evao">–ï–≤—Ä–µ–π—Å–∫–∞—è –ê–û</option>
                    <option value="nao">–ù–µ–Ω–µ—Ü–∫–∏–π –ê–û</option>
                    <option value="hmao">–•–∞–Ω—Ç—ã-–ú–∞–Ω—Å–∏–π—Å–∫–∏–π –ê–û</option>
                    <option value="chao">–ß—É–∫–æ—Ç—Å–∫–∏–π –ê–û</option>
                    <option value="yamalo">–Ø–º–∞–ª–æ-–ù–µ–Ω–µ—Ü–∫–∏–π –ê–û</option>
                </select>
                <input type="text" id="player1Name" class="w-2/3 p-2 border border-gray-300 rounded-md" placeholder="–ò–º—è –∏–≥—Ä–æ–∫–∞">
            </div>
        </div>

        <div class="mb-4">
            <label class="block text-gray-700 mb-2">–ò–≥—Ä–æ–∫ 2:</label>
            <div class="flex items-center">
                <select id="player2Country" class="w-1/3 p-2 border border-gray-300 rounded-md mr-2">
                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω</option>
                    <option value="ady">–ê–¥—ã–≥–µ—è</option>
                    <option value="alt">–ê–ª—Ç–∞–π</option>
                    <option value="bash">–ë–∞—à–∫–æ—Ä—Ç–æ—Å—Ç–∞–Ω</option>
                    <option value="bury">–ë—É—Ä—è—Ç–∏—è</option>
                    <option value="dnr">–î–æ–Ω–µ—Ü–∫–∞—è –Ω–∞—Ä–æ–¥–Ω–∞—è —Ä–µ—Å–ø—É–±–ª–∏–∫–∞ –î–ù–†</option>
                    <option value="dag">–î–∞–≥–µ—Å—Ç–∞–Ω</option>
                    <option value="ing">–ò–Ω–≥—É—à–µ—Ç–∏—è</option>
                    <option value="kb">–ö–∞–±–∞—Ä–¥–∏–Ω–æ-–ë–∞–ª–∫–∞—Ä–∏—è</option>
                    <option value="klm">–ö–∞–ª–º—ã–∫–∏—è</option>
                    <option value="kar">–ö–∞—Ä–∞—á–∞–µ–≤–æ-–ß–µ—Ä–∫–µ—Å–∏—è</option>
                    <option value="krl">–ö–∞—Ä–µ–ª–∏—è</option>
                    <option value="kom">–ö–æ–º–∏</option>
                    <option value="cr">–ö—Ä—ã–º</option>
                    <option value="lnr">–õ—É–≥–∞–Ω—Å–∫–∞—è –Ω–∞—Ä–æ–¥–Ω–∞—è —Ä–µ—Å–ø—É–±–ª–∏–∫–∞</option>
                    <option value="mr">–ú–∞—Ä–∏–π –≠–ª</option>
                    <option value="mrd">–ú–æ—Ä–¥–æ–≤–∏—è</option>
                    <option value="sak">–°–∞—Ö–∞ (–Ø–∫—É—Ç–∏—è)</option>
                    <option value="alv">–°–µ–≤–µ—Ä–Ω–∞—è –û—Å–µ—Ç–∏—è ‚Äî –ê–ª–∞–Ω–∏—è</option>
                    <option value="tat">–¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω</option>
                    <option value="tuv">–¢—ã–≤–∞</option>
                    <option value="udm">–£–¥–º—É—Ä—Ç–∏—è</option>
                    <option value="khk">–•–∞–∫–∞—Å–∏—è</option>
                    <option value="che">–ß–µ—á–Ω—è</option>
                    <option value="chv">–ß—É–≤–∞—à–∏—è</option>

                    <option value="altk">–ê–ª—Ç–∞–π—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="zbk">–ó–∞–±–∞–π–∫–∞–ª—å—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="kam">–ö–∞–º—á–∞—Ç—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="kras">–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="krd">–ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="per">–ü–µ—Ä–º—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="pri">–ü—Ä–∏–º–æ—Ä—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="sta">–°—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–∏–π –∫—Ä–∞–π</option>
                    <option value="hab">–•–∞–±–∞—Ä–æ–≤—Å–∫–∏–π –∫—Ä–∞–π</option>

                    <option value="amur">–ê–º—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="arh">–ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="ast">–ê—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="bel">–ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="bry">–ë—Ä—è–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="vla">–í–ª–∞–¥–∏–º–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="vlg">–í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="vls">–í–æ–ª–æ–≥–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="vrn">–í–æ—Ä–æ–Ω–µ–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="zpo">–ó–∞–ø–æ—Ä–æ–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="iva">–ò–≤–∞–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="irk">–ò—Ä–∫—É—Ç—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="klg">–ö–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="klz">–ö–∞–ª—É–∂—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="kem">–ö–µ–º–µ—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="kir">–ö–∏—Ä–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="kos">–ö–æ—Å—Ç—Ä–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="kur">–ö—É—Ä–≥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="kurs">–ö—É—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="len">–õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="lip">–õ–∏–ø–µ—Ü–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="mag">–ú–∞–≥–∞–¥–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="mos">–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="mur">–ú—É—Ä–º–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="nin">–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="nov">–ù–æ–≤–≥–æ—Ä–æ–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="nvs">–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="oms">–û–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="oren">–û—Ä–µ–Ω–±—É—Ä–≥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="orl">–û—Ä–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="pnz">–ü–µ–Ω–∑–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="psk">–ü—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="ros">–†–æ—Å—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="rya">–†—è–∑–∞–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="sam">–°–∞–º–∞—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="sar">–°–∞—Ä–∞—Ç–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="sah">–°–∞—Ö–∞–ª–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="sve">–°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="smo">–°–º–æ–ª–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="tam">–¢–∞–º–±–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="tom">–¢–æ–º—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="tvobl">–¢–≤–µ—Ä—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="tul">–¢—É–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="tyu">–¢—é–º–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="uly">–£–ª—å—è–Ω–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="xobl">–•–µ—Ä—Å–æ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="cheb">–ß–µ–ª—è–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>
                    <option value="yar">–Ø—Ä–æ—Å–ª–∞–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</option>

                    <option value="msk">–ú–æ—Å–∫–≤–∞</option>
                    <option value="spb">–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</option>
                    <option value="sev">–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å</option>

                    <option value="evao">–ï–≤—Ä–µ–π—Å–∫–∞—è –ê–û</option>
                    <option value="nao">–ù–µ–Ω–µ—Ü–∫–∏–π –ê–û</option>
                    <option value="hmao">–•–∞–Ω—Ç—ã-–ú–∞–Ω—Å–∏–π—Å–∫–∏–π –ê–û</option>
                    <option value="chao">–ß—É–∫–æ—Ç—Å–∫–∏–π –ê–û</option>
                    <option value="yamalo">–Ø–º–∞–ª–æ-–ù–µ–Ω–µ—Ü–∫–∏–π –ê–û</option>
                </select>
                <input type="text" id="player2Name" class="w-2/3 p-2 border border-gray-300 rounded-md" placeholder="–ò–º—è –∏–≥—Ä–æ–∫–∞">
            </div>
        </div>

        <div class="mb-4">
            <label class="block text-gray-700 mb-2">–°—á–µ—Ç:</label>
            <div class="flex items-center">
                <input type="number" id="player1Score" class="w-1/3 p-2 border border-gray-300 rounded-md mr-2" min="0" max="7">
                <span class="mx-2">:</span>
                <input type="number" id="player2Score" class="w-1/3 p-2 border border-gray-300 rounded-md" min="0" max="7">
            </div>
        </div>

        <div class="mb-4">
            <label class="block text-gray-700 mb-2">–°—á–µ—Ç –ø–æ —Å–µ—Ç–∞–º:</label>
            <input type="text" id="setSets" class="w-full p-2 border border-gray-300 rounded-md" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 11-9,9-11,11-7,11-5">
        </div>

        <div class="mb-4">
            <label class="block text-gray-700 mb-2">–ü–æ–±–µ–¥–∏—Ç–µ–ª—å:</label>
            <select id="matchWinner" class="w-full p-2 border border-gray-300 rounded-md">
                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–±–µ–¥–∏—Ç–µ–ª—è</option>
                <option value="player1">–ò–≥—Ä–æ–∫ 1</option>
                <option value="player2">–ò–≥—Ä–æ–∫ 2</option>
            </select>
        </div>

        <div class="mb-4">
            <label class="block text-gray-700 mb-2">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞—Ç—á–µ:</label>
            <input type="text" id="matchDate" class="w-full p-2 border border-gray-300 rounded-md mb-2" placeholder="–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, 15.06.2023 14:00)">
            <input type="text" id="tableNumber" class="w-full p-2 border border-gray-300 rounded-md mb-2" placeholder="–ù–æ–º–µ—Ä —Å—Ç–æ–ª–∞">
            <textarea id="matchNotes" class="w-full p-2 border border-gray-300 rounded-md" rows="2" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏"></textarea>
        </div>

        <div class="flex justify-end">
            <button id="cancelMatch" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg mr-2">
                –û—Ç–º–µ–Ω–∞
            </button>
            <button id="saveMatch" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg">
                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
            </button>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞ -->
<div id="renameTournamentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
    <div class="bg-white rounded-lg p-6 w-full max-w-md">
        <h3 class="text-xl font-bold mb-4">–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ç—É—Ä–Ω–∏—Ä</h3>

        <div class="mb-4">
            <label class="block text-gray-700 mb-2">–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:</label>
            <input type="text" id="newTournamentName" class="w-full p-2 border border-gray-300 rounded-md" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞">
        </div>

        <div class="flex justify-end">
            <button id="cancelRename" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg mr-2">
                –û—Ç–º–µ–Ω–∞
            </button>
            <button id="confirmRename" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg">
                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
            </button>
        </div>
    </div>
</div>

<!-- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –¥–ª—è –≤–∫–ª–∞–¥–æ–∫ -->
<div id="tabContextMenu" class="tab-context-menu hidden">
    <div id="renameTab" class="tab-context-menu-item">
        <i class="fas fa-edit mr-2"></i> –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å
    </div>
    <div id="deleteTab" class="tab-context-menu-item danger">
        <i class="fas fa-trash mr-2"></i> –£–¥–∞–ª–∏—Ç—å
    </div>
</div>

<script>
    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    let isAdminMode = true;
    let tournaments = [];
    let currentTournamentIndex = 0;
    let viewSettings = {
        startRound: 0,
        endRound: 7
    };
    let currentEditingMatch = null;
    let mouseTimer = null;
    let isMouseMoving = false;
    let contextMenuTarget = null;
    let scrollAnimationActive = false;
    let scrollInterval = null;
    let playerPathMap = new Map(); // –ö–∞—Ä—Ç–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—É—Ç–µ–π –∏–≥—Ä–æ–∫–æ–≤

    // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
    const tournamentBracket = document.getElementById('tournamentBracket');
    const adminPanel = document.getElementById('adminPanel');
    const viewerControls = document.getElementById('viewerControls');
    const tournamentTabs = document.getElementById('tournamentTabs');
    const toggleModeBtn = document.getElementById('toggleMode');
    const createTournamentBtn = document.getElementById('createTournament');
    const saveTournamentBtn = document.getElementById('saveTournament');
    const loadTournamentBtn = document.getElementById('loadTournament');
    const applyViewSettingsBtn = document.getElementById('applyViewSettings');
    const matchModal = document.getElementById('matchModal');
    const saveMatchBtn = document.getElementById('saveMatch');
    const cancelMatchBtn = document.getElementById('cancelMatch');
    const renameTournamentModal = document.getElementById('renameTournamentModal');
    const newTournamentNameInput = document.getElementById('newTournamentName');
    const confirmRenameBtn = document.getElementById('confirmRename');
    const cancelRenameBtn = document.getElementById('cancelRename');
    const tabContextMenu = document.getElementById('tabContextMenu');
    const renameTabBtn = document.getElementById('renameTab');
    const deleteTabBtn = document.getElementById('deleteTab');

    // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤
    toggleModeBtn.addEventListener('click', () => {
        isAdminMode = !isAdminMode;
        toggleModeBtn.textContent = isAdminMode ? '–†–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞' : '–†–µ–∂–∏–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞';
        toggleModeBtn.classList.toggle('bg-blue-600', isAdminMode);
        toggleModeBtn.classList.toggle('bg-blue-600', !isAdminMode);
        adminPanel.style.display = isAdminMode ? 'block' : 'none';
        viewerControls.style.display = isAdminMode ? 'none' : 'block';

        // –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω —Ä–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞, —Å–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        if (!isAdminMode) {
            hideViewerControls();
            setupMouseMovementDetection();
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–≤–µ—Ä—Ö
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–∞
            startScrollAnimation();
        } else {
            showViewerControls();
            clearMouseMovementDetection();
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–∞
            stopScrollAnimation();
        }

        // –ü–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º —Ç—É—Ä–Ω–∏—Ä —Å —É—á–µ—Ç–æ–º —Ä–µ–∂–∏–º–∞
        if (tournaments.length > 0) {
            renderTournament(tournaments[currentTournamentIndex]);
        }
    });

    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è/–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —Ä–µ–∂–∏–º–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
    function hideViewerControls() {
        document.querySelectorAll('.viewer-controls').forEach(el => {
            el.classList.add('hidden');
            el.style.display='none';
        });
    }

    function showViewerControls() {
        document.querySelectorAll('.viewer-controls').forEach(el => {
            el.classList.remove('hidden');
            el.style.display='';
        });
    }

    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –º—ã—à–∏
    function setupMouseMovementDetection() {
        document.addEventListener('mousemove', handleMouseMove);
        // –°–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
        setTimeout(hideViewerControls, 3000);
    }

    function clearMouseMovementDetection() {
        document.removeEventListener('mousemove', handleMouseMove);
        if (mouseTimer) {
            clearTimeout(mouseTimer);
            mouseTimer = null;
        }
    }

    function handleMouseMove() {
        showViewerControls();
        isMouseMoving = true;

        if (mouseTimer) {
            clearTimeout(mouseTimer);
        }

        mouseTimer = setTimeout(() => {
            isMouseMoving = false;
            hideViewerControls();
        }, 3000);
    }

    // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–∞
    function startScrollAnimation() {
        if (scrollAnimationActive) return;

        scrollAnimationActive = true;
        tournamentContainer.classList.add('scroll-animation');

        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–∞ –¥–ª—è –≤—Å–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        const scrollHeight = Math.max(
            document.body.scrollHeight,
            document.documentElement.scrollHeight,
            document.body.offsetHeight,
            document.documentElement.offsetHeight
        ) - window.innerHeight;

        let scrollDirection = 1; // 1 - –≤–Ω–∏–∑, -1 - –≤–≤–µ—Ä—Ö
        let currentPosition = 0;

        scrollInterval = setInterval(() => {
            if (isMouseMoving) return; // –ù–µ —Å–∫—Ä–æ–ª–ª–∏–º, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–≤–∏–≥–∞–µ—Ç –º—ã—à—å—é

            currentPosition += scrollDirection * 2.5; // –ú–µ–¥–ª–µ–Ω–Ω—ã–π —Å–∫—Ä–æ–ª–ª–∏–Ω–≥

            if (currentPosition >= scrollHeight) {
                scrollDirection = -1;
            } else if (currentPosition <= 0) {
                scrollDirection = 1;
            }

            window.scrollTo({
                top: currentPosition,
                behavior: 'smooth' // –ò—Å–ø–æ–ª—å–∑—É–µ–º 'auto' –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
            });
        }, 50);
    }

    function stopScrollAnimation() {
        if (!scrollAnimationActive) return;

        scrollAnimationActive = false;
        tournamentContainer.classList.remove('scroll-animation');

        if (scrollInterval) {
            clearInterval(scrollInterval);
            scrollInterval = null;
        }
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç—É—Ä–Ω–∏—Ä–∞
    createTournamentBtn.addEventListener('click', () => {
        const playerCount = parseInt(document.getElementById('playerCount').value);
        const tournamentName = document.getElementById('tournamentName').value || `–¢—É—Ä–Ω–∏—Ä ${tournaments.length + 1}`;

        const newTournament = generateTournament(playerCount, 'single', tournamentName);
        tournaments.push(newTournament);
        currentTournamentIndex = tournaments.length - 1;

        updateTournamentTabs();
        renderTournament(newTournament);
    });

    // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞
    saveTournamentBtn.addEventListener('click', async () => {
        if (tournaments.length === 0) {
            alert('–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ —Ç—É—Ä–Ω–∏—Ä!');
            return;
        }

        try {
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ API
            await fetch('/api/olympic', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(tournaments)
            });

            alert('–¢—É—Ä–Ω–∏—Ä —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏:', error);
            // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏, –µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
            alert('–¢—É—Ä–Ω–∏—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ (–∏–º–∏—Ç–∞—Ü–∏—è API)');
            localStorage.setItem('savedTournaments', JSON.stringify(tournaments));
        }
    });

    // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—É—Ä–Ω–∏—Ä–∞
    loadTournamentBtn.addEventListener('click', async () => {
        try {
            // –ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ API
            const res = await fetch('/api/olympic');
            const loadedTournament = await res.json();

            if (loadedTournament) {
                tournaments = loadedTournament;
                currentTournamentIndex = 0;
                updateTournamentTabs();
                renderTournament(loadedTournament[currentTournamentIndex]);
                console.log('–¢—É—Ä–Ω–∏—Ä —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!');
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:', error);

            // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏, –µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Ç—É—Ä–Ω–∏—Ä
            const testTournament = generateTournament(16, 'single', '–¢–µ—Å—Ç–æ–≤—ã–π —Ç—É—Ä–Ω–∏—Ä');
            populateWithSampleData(testTournament);
            tournaments.push(testTournament);
            currentTournamentIndex = tournaments.length - 1;
            updateTournamentTabs();
            renderTournament(testTournament);
            alert('–ó–∞–≥—Ä—É–∂–µ–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Ç—É—Ä–Ω–∏—Ä (–∏–º–∏—Ç–∞—Ü–∏—è API)');
        }
    });

    // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
    applyViewSettingsBtn.addEventListener('click', () => {
        viewSettings.startRound = parseInt(document.getElementById('startRound').value);
        viewSettings.endRound = parseInt(document.getElementById('endRound').value);

        if (viewSettings.startRound > viewSettings.endRound) {
            alert('–û—à–∏–±–∫–∞: –Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–∞—É–Ω–¥ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª—å—à–µ –∫–æ–Ω–µ—á–Ω–æ–≥–æ');
            return;
        }

        if (tournaments.length > 0) {
            renderTournament(tournaments[currentTournamentIndex]);
        }
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ç—á–∞
    saveMatchBtn.addEventListener('click', () => {
        if (!currentEditingMatch) return;

        const player1Name = document.getElementById('player1Name').value;
        const player1Country = document.getElementById('player1Country').value;
        const player2Name = document.getElementById('player2Name').value;
        const player2Country = document.getElementById('player2Country').value;
        const player1Score = document.getElementById('player1Score').value;
        const player2Score = document.getElementById('player2Score').value;
        const winner = document.getElementById('matchWinner').value;
        const matchDate = document.getElementById('matchDate').value;
        const tableNumber = document.getElementById('tableNumber').value;
        const matchNotes = document.getElementById('matchNotes').value;
        const sets = document.getElementById('setSets').value;

        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –º–∞—Ç—á–∞
        currentEditingMatch.players[0].name = player1Name;
        currentEditingMatch.players[0].country = player1Country;
        currentEditingMatch.players[1].name = player2Name;
        currentEditingMatch.players[1].country = player2Country;

        if (player1Score !== '' && player2Score !== '') {
            currentEditingMatch.score = `${player1Score}‚Äì${player2Score}`;
        }

        // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ—Ç–∞—Ö
        if (sets) {
            currentEditingMatch.sets = sets;
        }

        if (winner) {
            currentEditingMatch.winner = winner === 'player1' ? 0 : 1;

            // –ü—Ä–æ–¥–≤–∏–≥–∞–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥
            const nextRound = currentEditingMatch.round - 1; // –û–±—Ä–∞—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —Ä–∞—É–Ω–¥–æ–≤
            const nextMatchIndex = Math.floor(currentEditingMatch.matchIndex / 2);
            const nextPlayerIndex = currentEditingMatch.matchIndex % 2;

            const currentTournament = tournaments[currentTournamentIndex];
            if (nextRound >= 0) {
                const winnerPlayer = currentEditingMatch.players[currentEditingMatch.winner];

                if (currentTournament.rounds[nextRound][nextMatchIndex]) {
                    currentTournament.rounds[nextRound][nextMatchIndex].players[nextPlayerIndex] = {
                        name: winnerPlayer.name,
                        country: winnerPlayer.country,
                        seed: winnerPlayer.seed
                    };
                }
            }
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–∞—Ç—á–µ
        currentEditingMatch.info = {
            date: matchDate,
            table: tableNumber,
            notes: matchNotes
        };

        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏ –æ–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        matchModal.classList.add('hidden');
        matchModal.classList.remove('flex');
        currentEditingMatch = null;

        renderTournament(tournaments[currentTournamentIndex]);

        try {
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ API
             fetch('/api/olympic', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(tournaments)
            });

            console.log('–¢—É—Ä–Ω–∏—Ä —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏:', error);
            // –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏, –µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
            alert('–¢—É—Ä–Ω–∏—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ (–∏–º–∏—Ç–∞—Ü–∏—è API)');
            localStorage.setItem('savedTournaments', JSON.stringify(tournaments));
        }
    });

    cancelMatchBtn.addEventListener('click', () => {
        matchModal.classList.add('hidden');
        matchModal.classList.remove('flex');
        currentEditingMatch = null;
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞
    confirmRenameBtn.addEventListener('click', () => {
        const newName = newTournamentNameInput.value.trim();
        if (newName && contextMenuTarget !== null) {
            tournaments[contextMenuTarget].name = newName;
            updateTournamentTabs();
            renameTournamentModal.classList.add('hidden');
            renameTournamentModal.classList.remove('flex');
        }
    });

    cancelRenameBtn.addEventListener('click', () => {
        renameTournamentModal.classList.add('hidden');
        renameTournamentModal.classList.remove('flex');
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω—é –≤–∫–ª–∞–¥–æ–∫
    renameTabBtn.addEventListener('click', () => {
        if (contextMenuTarget !== null) {
            newTournamentNameInput.value = tournaments[contextMenuTarget].name;
            renameTournamentModal.classList.remove('hidden');
            renameTournamentModal.classList.add('flex');
            hideContextMenu();
        }
    });

    deleteTabBtn.addEventListener('click', () => {
        if (contextMenuTarget !== null && tournaments.length > 1) {
            if (confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Ç—É—Ä–Ω–∏—Ä "${tournaments[contextMenuTarget].name}"?`)) {
                tournaments.splice(contextMenuTarget, 1);
                if (currentTournamentIndex >= tournaments.length) {
                    currentTournamentIndex = tournaments.length - 1;
                }
                updateTournamentTabs();
                renderTournament(tournaments[currentTournamentIndex]);
            }
            hideContextMenu();
        } else if (tournaments.length <= 1) {
            alert('–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç—É—Ä–Ω–∏—Ä');
            hideContextMenu();
        }
    });

    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–≥–æ –º–µ–Ω—é
    function showContextMenu(event, index) {
        event.preventDefault();
        contextMenuTarget = index;

        const rect = event.target.getBoundingClientRect();
        tabContextMenu.style.top = `${rect.bottom + window.scrollY}px`;
        tabContextMenu.style.left = `${rect.left + window.scrollX}px`;
        tabContextMenu.classList.remove('hidden');

        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
        document.addEventListener('click', hideContextMenuOnClick);
    }

    function hideContextMenu() {
        tabContextMenu.classList.add('hidden');
        document.removeEventListener('click', hideContextMenuOnClick);
    }

    function hideContextMenuOnClick(event) {
        if (!tabContextMenu.contains(event.target)) {
            hideContextMenu();
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–∫–ª–∞–¥–æ–∫ —Ç—É—Ä–Ω–∏—Ä–æ–≤
    function updateTournamentTabs() {
        tournamentTabs.innerHTML = '';

        tournaments.forEach((tournament, index) => {
            const tabElement = document.createElement('div');
            tabElement.className = `tournament-tab ${index === currentTournamentIndex ? 'active' : ''}`;
            tabElement.textContent = tournament.name;
            tabElement.addEventListener('click', () => {
                currentTournamentIndex = index;
                updateTournamentTabs();
                renderTournament(tournaments[currentTournamentIndex]);
            });

            // –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é –¥–ª—è –≤–∫–ª–∞–¥–æ–∫ –≤ —Ä–µ–∂–∏–º–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
            if (isAdminMode) {
                tabElement.addEventListener('contextmenu', (event) => {
                    showContextMenu(event, index);
                });

                // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –¥–µ–π—Å—Ç–≤–∏–π
                const actionsBtn = document.createElement('div');
                actionsBtn.className = 'tab-actions';
                actionsBtn.innerHTML = '‚ãÆ';
                actionsBtn.addEventListener('click', (event) => {
                    event.stopPropagation();
                    showContextMenu(event, index);
                });

                tabElement.appendChild(actionsBtn);
            }

            tournamentTabs.appendChild(tabElement);
        });

        // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ç—É—Ä–Ω–∏—Ä–∞
        if (isAdminMode) {
            const newTabElement = document.createElement('div');
            newTabElement.className = 'tournament-tab';
            newTabElement.textContent = '+ –ù–æ–≤—ã–π —Ç—É—Ä–Ω–∏—Ä';
            newTabElement.addEventListener('click', () => {
                createTournamentBtn.click();
            });

            tournamentTabs.appendChild(newTabElement);
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç—É—Ä–Ω–∏—Ä–∞
    function generateTournament(playerCount, type, name) {
        const rounds = Math.log2(playerCount);
        const tournament = {
            name: name,
            playerCount,
            type,
            rounds: []
        };

        // –°–æ–∑–¥–∞–µ–º —Ä–∞—É–Ω–¥—ã (–æ—Ç —Ñ–∏–Ω–∞–ª–∞ –∫ –ø–µ—Ä–≤–æ–º—É —Ä–∞—É–Ω–¥—É)
        for (let r = 0; r < rounds; r++) {
            const matchesInRound = Math.pow(2, r);
            const roundMatches = [];

            for (let m = 0; m < matchesInRound; m++) {
                roundMatches.push({
                    round: r,
                    matchIndex: m,
                    players: [
                        { name: '', country: 'ru' },
                        { name: '', country: 'ru' }
                    ],
                    score: '',
                    winner: null,
                    info: {
                        date: '',
                        table: '',
                        notes: ''
                    }
                });
            }

            tournament.rounds.push(roundMatches);
        }

        return tournament;
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ç—É—Ä–Ω–∏—Ä–∞ —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    function populateWithSampleData(tournament) {
        const names = [
            '–ò–≤–∞–Ω–æ–≤ –ê.', '–ü–µ—Ç—Ä–æ–≤ –°.', '–°–∏–¥–æ—Ä–æ–≤ –ò.', '–°–º–∏—Ä–Ω–æ–≤ –ö.',
            '–ö—É–∑–Ω–µ—Ü–æ–≤ –î.', '–ü–æ–ø–æ–≤ –ú.', '–í–∞—Å–∏–ª—å–µ–≤ –ù.', '–°–æ–∫–æ–ª–æ–≤ –ê.',
            '–ú–∏—Ö–∞–π–ª–æ–≤ –í.', '–ù–æ–≤–∏–∫–æ–≤ –ì.', '–§–µ–¥–æ—Ä–æ–≤ –ï.', '–ú–æ—Ä–æ–∑–æ–≤ –õ.',
            '–í–æ–ª–∫–æ–≤ –ü.', '–ê–ª–µ–∫—Å–µ–µ–≤ –†.', '–õ–µ–±–µ–¥–µ–≤ –¢.', '–°–µ–º–µ–Ω–æ–≤ –Æ.'
        ];

        const countries = ['ru', 'by', 'kz', 'ua', 'cn', 'jp', 'kr', 'de'];

        // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–µ—Ä–≤—ã–π —Ä–∞—É–Ω–¥ (—Å–∞–º—ã–π –±–æ–ª—å—à–æ–π)
        const firstRoundIndex = tournament.rounds.length - 1;
        for (let i = 0; i < tournament.rounds[firstRoundIndex].length; i++) {
            const match = tournament.rounds[firstRoundIndex][i];
            match.players[0].name = names[i * 2 % names.length];
            match.players[0].country = countries[Math.floor(Math.random() * countries.length)];
            match.players[1].name = names[(i * 2 + 1) % names.length];
            match.players[1].country = countries[Math.floor(Math.random() * countries.length)];

            // –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–∞—Ç—á–µ–π
            if (i < tournament.rounds[firstRoundIndex].length / 2) {
                const score1 = Math.floor(Math.random() * 4) + 2;
                const score2 = Math.floor(Math.random() * 2);
                match.score = `${score1}‚Äì${score2}`;
                match.winner = 0; // –ü–µ—Ä–≤—ã–π –∏–≥—Ä–æ–∫ –ø–æ–±–µ–¥–∏–ª

                // –î–æ–±–∞–≤–ª—è–µ–º —Å—á–µ—Ç –ø–æ —Å–µ—Ç–∞–º
                const setsCount = score1 + score2;
                const sets = [];
                for (let s = 0; s < setsCount; s++) {
                    const player1Points = s < score1 ? 11 : Math.floor(Math.random() * 9) + 1;
                    const player2Points = s < score1 ? Math.floor(Math.random() * 9) + 1 : 11;
                    sets.push(`${player1Points}-${player2Points}`);
                }
                match.sets = sets.join(',');

                // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞—Ç—á–µ
                match.info = {
                    date: `15.06.2023 ${10 + i}:00`,
                    table: `–°—Ç–æ–ª ${i + 1}`,
                    notes: '1/16 —Ñ–∏–Ω–∞–ª–∞'
                };

                // –ü—Ä–æ–¥–≤–∏–≥–∞–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥
                if (firstRoundIndex > 0) {
                    const nextRoundIndex = firstRoundIndex - 1;
                    const nextMatchIndex = Math.floor(i / 2);
                    const nextPlayerIndex = i % 2;
                    tournament.rounds[nextRoundIndex][nextMatchIndex].players[nextPlayerIndex] = {
                        name: match.players[0].name,
                        country: match.players[0].country
                    };
                }
            }
        }

        // –ó–∞–ø–æ–ª–Ω—è–µ–º –≤—Ç–æ—Ä–æ–π —Ä–∞—É–Ω–¥ (–µ—Å–ª–∏ –µ—Å—Ç—å)
        if (tournament.rounds.length > 1) {
            const secondRoundIndex = tournament.rounds.length - 2;
            for (let i = 0; i < tournament.rounds[secondRoundIndex].length / 2; i++) {
                const match = tournament.rounds[secondRoundIndex][i];
                if (match.players[0].name && match.players[1].name) {
                    const score1 = Math.floor(Math.random() * 3) + 3;
                    const score2 = Math.floor(Math.random() * 2) + 1;
                    match.score = `${score1}‚Äì${score2}`;
                    match.winner = 0;

                    // –î–æ–±–∞–≤–ª—è–µ–º —Å—á–µ—Ç –ø–æ —Å–µ—Ç–∞–º
                    const setsCount = score1 + score2;
                    const sets = [];
                    for (let s = 0; s < setsCount; s++) {
                        const player1Points = s < score1 ? 11 : Math.floor(Math.random() * 9) + 1;
                        const player2Points = s < score1 ? Math.floor(Math.random() * 9) + 1 : 11;
                        sets.push(`${player1Points}-${player2Points}`);
                    }
                    match.sets = sets.join(',');

                    match.info = {
                        date: `16.06.2023 ${10 + i}:00`,
                        table: `–°—Ç–æ–ª ${i + 1}`,
                        notes: '1/8 —Ñ–∏–Ω–∞–ª–∞'
                    };

                    // –ü—Ä–æ–¥–≤–∏–≥–∞–µ–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥
                    if (secondRoundIndex > 0) {
                        const nextRoundIndex = secondRoundIndex - 1;
                        const nextMatchIndex = Math.floor(i / 2);
                        const nextPlayerIndex = i % 2;
                        tournament.rounds[nextRoundIndex][nextMatchIndex].players[nextPlayerIndex] = {
                            name: match.players[0].name,
                            country: match.players[0].country
                        };
                    }
                }
            }
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Ç—É—Ä–Ω–∏—Ä–∞
    function renderTournament(tournament) {
        if (!tournament || !tournament.rounds) return;

        tournamentBracket.innerHTML = '';
        playerPathMap.clear(); // –û—á–∏—â–∞–µ–º –∫–∞—Ä—Ç—É –ø—É—Ç–µ–π –∏–≥—Ä–æ–∫–æ–≤

        // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ª–∏–Ω–∏–π
        const connectorWrapper = document.createElement('div');
        connectorWrapper.className = 'connector-wrapper';

        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫–∞–∫–∏–µ —Ä–∞—É–Ω–¥—ã –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å
        const startRoundIndex = Math.min(viewSettings.startRound, tournament.rounds.length - 1);

        const endRoundIndex = Math.min(viewSettings.endRound, tournament.rounds.length - 1);

        // –°–æ–∑–¥–∞–µ–º —Ä–∞—É–Ω–¥—ã –≤ –ø–æ—Ä—è–¥–∫–µ –æ—Ç —Ñ–∏–Ω–∞–ª–∞ –∫ –ø–µ—Ä–≤–æ–º—É —Ä–∞—É–Ω–¥—É
        for (let i = startRoundIndex; i <= endRoundIndex; i++) {
            const roundIndex = tournament.rounds.length - 1 - i;
            const round = tournament.rounds[roundIndex];

            const roundElement = document.createElement('div');
            roundElement.className = 'round';

            // –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞—É–Ω–¥–∞
            const roundName = getRoundName(roundIndex, tournament.rounds.length);
            roundElement.innerHTML = `<h3 class="text-center font-bold mb-4">${roundName}</h3>`;

            // –°–æ–∑–¥–∞–µ–º –º–∞—Ç—á–∏
            round.forEach((match, matchIndex) => {
                const matchElement = document.createElement('div');
                matchElement.className = 'match';
                matchElement.dataset.round = roundIndex;
                matchElement.dataset.match = matchIndex;

                // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∏–≥—Ä–æ–∫–æ–≤
                match.players.forEach((player, playerIndex) => {
                    const isWinner = match.winner === playerIndex;
                    const playerElement = document.createElement('div');
                    playerElement.className = `player ${isWinner ? 'winner' : ''}`;
                    playerElement.dataset.playerName = player.name;
                    playerElement.dataset.round = roundIndex;
                    playerElement.dataset.match = matchIndex;
                    playerElement.dataset.playerIndex = playerIndex;

                    // –§–ª–∞–≥ —Å—Ç—Ä–∞–Ω—ã
                    const flagElement = document.createElement('img');
                    flagElement.className = `flag-icon`;

                    let flagSvg = '';
                    switch (player.country) {
                        case 'ady':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_adygea_new.jpg";
                            break;
                        case 'alt':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_altay_new.jpg";
                            break;
                        case 'bash':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_bashkorkostan_res_new.jpg";
                            break;
                        case 'bury':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_buryatiya_new.jpg";
                            break;
                        case 'dnr':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_dnr.jpg";
                            break;
                        case 'dag':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_dagestan_enl.jpg";
                            break;
                        case 'ing':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_ingushetiya_enl.jpg";
                            break;
                        case 'kb':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kabardino_balkarskoy_pes_enl.jpg";
                            break;
                        case 'klm':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kalmyikiya_enl.jpg";
                            break;
                        case 'kar':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_karachaevo_cherkesskay_res_new.jpg";
                            break;
                        case 'krl':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kareliya_enl.jpg";
                            break;
                        case 'kom':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_komi_new.jpg";
                            break;
                        case 'cr':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_krym.jpg";
                            break;
                        case 'lnr':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_lnr1.jpg";
                            break;
                        case 'mr':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_mari_el_new.jpg";
                            break;
                        case 'mrd':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_mordovia_enl.jpg";
                            break;
                        case 'sak':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_saha_yakuyiya_new.jpg";
                            break;
                        case 'alv':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_sev_osetiya_new.jpg";
                            break;
                        case 'tat':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_tatarstan_new.jpg";
                            break;
                        case 'tuv':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_tyva_new.jpg";
                            break;
                        case 'udm':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_udmurtiya_res_new.jpg";
                            break;
                        case 'khk':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_hakasia_new.jpg";
                            break;
                        case 'che':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_chechni.jpg";
                            break;
                        case 'chv':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_chuvashskaya_res_new.jpg";
                            break;
                        case 'altk':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_altay_kray_enl.jpg";
                            break;
                        case 'zbk':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_zabaykalskiy_kray_enl.jpg";
                            break;
                        case 'kam':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kamchatskiy_kray_new.jpg";
                            break;
                        case 'kras':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_krasnodarskiy_kray_new.jpg";
                            break;
                        case 'krd':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_krasnoyarskiy_kray_new.jpg";
                            break;
                        case 'per':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_permskiy_kray_new.jpg";
                            break;
                        case 'pri':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_primorskiy_kray_new.jpg";
                            break;
                        case 'sta':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_stavropolskiy_kray_new.jpg";
                            break;
                        case 'hab':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_habarovskiy_kray_new.jpg";
                            break;
                        case 'tvobl':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_tverskaya_obl_new.jpg";
                            break;
                        case 'amur':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_amurskay_obl_new.jpg";
                            break;
                        case 'arh':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_arhangelskaja_obl_new.jpg";
                            break;
                        case 'ast':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_astrahanskay_obl_new.jpg";
                            break;
                        case 'bel':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_belgorodskay_obl_new_0.jpg";
                            break;
                        case 'bry':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_bryanskay_obl_new.jpg";
                            break;
                        case 'vla':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_vladim_obl.jpg";
                            break;
                        case 'vlg':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_volgograd_obl_enl.jpg";
                            break;
                        case 'vls':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_vologodskay_obl_enl_0.jpg";
                            break;
                        case 'vrn':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_voronezskay_obl_enl.jpg";
                            break;
                        case 'zpo':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_zaporogskaia_obl.jpg";
                            break;
                        case 'iva':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_ivanovskay_obl_enl.jpg";
                            break;
                        case 'irk':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_irkutskay_obl_new.jpg";
                            break;
                        case 'klg':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kaliningradskoy_obl_new.jpg";
                            break;
                        case 'klz':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kaluzskay_obl_enl.jpg";
                            break;
                        case 'kem':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kemerovskay_obl_new.jpg";
                            break;
                        case 'kir':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kirovskay_obl_new.jpg";
                            break;
                        case 'kos':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kostromskay_obl_enl.jpg";
                            break;
                        case 'kur':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kurganskay_obl_enl.jpg";
                            break;
                        case 'kurs':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kurskay_obl_new.jpg";
                            break;
                        case 'len':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_leningradskay_obl_new.jpg";
                            break;
                        case 'lip':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_lipetskay_obl_enl.jpg";
                            break;
                        case 'mag':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_magadanskay_obl_enl.jpg";
                            break;
                        case 'mos':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_moskovskay_obl_new.jpg";
                            break;
                        case 'mur':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_murmanskay_obl_new.jpg";
                            break;
                        case 'nin':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_nizegorodskay_obl_new.jpg";
                            break;
                        case 'nov':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_novgorodskay_obl_new.jpg";
                            break;
                        case 'nvs':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_novosibirskay_obl_new.jpg";
                            break;
                        case 'oms':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_omskay_obl_new.jpg";
                            break;
                        case 'oren':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_orenburskay_obl_enl.jpg";
                            break;
                        case 'orl':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_orlovskay_obl_enl.jpg";
                            break;
                        case 'pnz':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_penza_region_new.jpg";
                            break;
                        case 'psk':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_pskovskay_obl_new.jpg";
                            break;
                        case 'ros':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_rostovskaya_obl_enl.jpg";
                            break;
                        case 'rya':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_ryazanskaya_obl_enl.jpg";
                            break;
                        case 'sam':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_samarskaya_obl_new.jpg";
                            break;
                        case 'sar':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_saratovskaya_obl_enl_0.jpg";
                            break;
                        case 'sah':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_sahalinskaya_obl_enl.jpg";
                            break;
                        case 'sve':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_sverdlovskaya_obl_new.jpg";
                            break;
                        case 'smo':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_smolenskaya_obl_enl.jpg";
                            break;
                        case 'tam':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_tambovskaya_obl_new.jpg";
                            break;
                        case 'tom':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_tomskaya_obl_enl.jpg";
                            break;
                        case 'tul':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_tulskaya_obl_enl.jpg";
                            break;
                        case 'tyu':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_tumenskaya_obl_enl.jpg";
                            break;
                        case 'uly':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_ulyanovskaya_obl_new.jpg";
                            break;
                        case 'xobl':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_hersonskaia_obl.jpg";
                            break;
                        case 'cheb':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_chelyabinskaya_obl_enl.jpg";
                            break;
                        case 'yar':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_yaroslavskaya_obl_enl.jpg";
                            break;
                        case 'msk':
                            flagSvg = "https://upload.wikimedia.org/wikipedia/commons/thumb/0/03/Flag_of_Moscow%2C_Russia.svg/1280px-Flag_of_Moscow%2C_Russia.svg.png";
                            break;
                        case 'spb':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_st_peterburg.jpg";
                            break;
                        case 'sev':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_sevastopol.jpg";
                            break;
                        case 'evao':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_evrejskaja_ao.jpg";
                            break;
                        case 'nao':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_nenetskiy_avt_okrug_enl.jpg";
                            break;
                        case 'hmao':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_hanty_mansiyskiy_avt_okr1.jpg";
                            break;
                        case 'chao':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_chucotskiy_avt_okr_new.jpg";
                            break;
                        case 'yamalo':
                            flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_jamalo_neneckogo_avt_okr.jpg";
                            break;
                        default:
                            flagSvg = 'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/Olympic_flag.svg/330px-Olympic_flag.svg.png'
                    }

                    flagElement.src = flagSvg;



                    // –ò–º—è –∏–≥—Ä–æ–∫–∞
                    const nameElement = document.createElement('span');
                    nameElement.className = 'player-name';
                    nameElement.textContent = player.name || '‚Äî'; // –ü—Ä–æ—á–µ—Ä–∫, –µ—Å–ª–∏ –∏–º—è –Ω–µ —É–∫–∞–∑–∞–Ω–æ

                    // –°—á–µ—Ç
                    const scoreElement = document.createElement('span');
                    scoreElement.className = 'player-score';

                    if (match.score) {
                        const scores = match.score.split('‚Äì');
                        scoreElement.textContent = playerIndex === 0 ? scores[0] : scores[1];
                    }

                    // –°–æ–∑–¥–∞–µ–º –≤—Å–ø–ª—ã–≤–∞—é—â—É—é –ø–æ–¥—Å–∫–∞–∑–∫—É —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –º–∞—Ç—á–µ
                    if (player.name) {
                        const tooltipElement = document.createElement('div');
                        tooltipElement.className = 'player-tooltip';

                        // –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ–¥—Å–∫–∞–∑–∫–∏
                        const tooltipHeader = document.createElement('div');
                        tooltipHeader.className = 'tooltip-header';

                        const tooltipFlag = document.createElement('img');
                        tooltipFlag.className = `flag-icon`;

                        let flagSvg = '';
                        switch (player.country) {
                            case 'ady':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_adygea_new.jpg";
                                break;
                            case 'alt':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_altay_new.jpg";
                                break;
                            case 'bash':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_bashkorkostan_res_new.jpg";
                                break;
                            case 'bury':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_buryatiya_new.jpg";
                                break;
                            case 'dnr':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_dnr.jpg";
                                break;
                            case 'dag':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_dagestan_enl.jpg";
                                break;
                            case 'ing':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_ingushetiya_enl.jpg";
                                break;
                            case 'kb':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kabardino_balkarskoy_pes_enl.jpg";
                                break;
                            case 'klm':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kalmyikiya_enl.jpg";
                                break;
                            case 'kar':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_karachaevo_cherkesskay_res_new.jpg";
                                break;
                            case 'krl':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kareliya_enl.jpg";
                                break;
                            case 'kom':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_komi_new.jpg";
                                break;
                            case 'cr':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_krym.jpg";
                                break;
                            case 'lnr':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_lnr1.jpg";
                                break;
                            case 'mr':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_mari_el_new.jpg";
                                break;
                            case 'mrd':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_mordovia_enl.jpg";
                                break;
                            case 'sak':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_saha_yakuyiya_new.jpg";
                                break;
                            case 'alv':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_sev_osetiya_new.jpg";
                                break;
                            case 'tat':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_tatarstan_new.jpg";
                                break;
                            case 'tuv':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_tyva_new.jpg";
                                break;
                            case 'udm':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_udmurtiya_res_new.jpg";
                                break;
                            case 'khk':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_hakasia_new.jpg";
                                break;
                            case 'che':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_chechni.jpg";
                                break;
                            case 'chv':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_chuvashskaya_res_new.jpg";
                                break;
                            case 'altk':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_altay_kray_enl.jpg";
                                break;
                            case 'zbk':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_zabaykalskiy_kray_enl.jpg";
                                break;
                            case 'kam':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kamchatskiy_kray_new.jpg";
                                break;
                            case 'kras':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_krasnodarskiy_kray_new.jpg";
                                break;
                            case 'krd':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_krasnoyarskiy_kray_new.jpg";
                                break;
                            case 'per':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_permskiy_kray_new.jpg";
                                break;
                            case 'pri':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_primorskiy_kray_new.jpg";
                                break;
                            case 'sta':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_stavropolskiy_kray_new.jpg";
                                break;
                            case 'hab':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_habarovskiy_kray_new.jpg";
                                break;
                            case 'amur':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_amurskay_obl_new.jpg";
                                break;
                            case 'arh':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_arhangelskaja_obl_new.jpg";
                                break;
                            case 'ast':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_astrahanskay_obl_new.jpg";
                                break;
                            case 'bel':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_belgorodskay_obl_new_0.jpg";
                                break;
                            case 'bry':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_bryanskay_obl_new.jpg";
                                break;
                            case 'vla':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_vladim_obl.jpg";
                                break;
                            case 'vlg':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_volgograd_obl_enl.jpg";
                                break;
                            case 'vls':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_vologodskay_obl_enl_0.jpg";
                                break;
                            case 'vrn':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_voronezskay_obl_enl.jpg";
                                break;
                            case 'zpo':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_zaporogskaia_obl.jpg";
                                break;
                            case 'iva':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_ivanovskay_obl_enl.jpg";
                                break;
                            case 'irk':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_irkutskay_obl_new.jpg";
                                break;
                            case 'klg':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kaliningradskoy_obl_new.jpg";
                                break;
                            case 'klz':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kaluzskay_obl_enl.jpg";
                                break;
                            case 'kem':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kemerovskay_obl_new.jpg";
                                break;
                            case 'kir':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kirovskay_obl_new.jpg";
                                break;
                            case 'kos':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kostromskay_obl_enl.jpg";
                                break;
                            case 'kur':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kurganskay_obl_enl.jpg";
                                break;
                            case 'kurs':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_kurskay_obl_new.jpg";
                                break;
                            case 'len':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_leningradskay_obl_new.jpg";
                                break;
                            case 'lip':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_lipetskay_obl_enl.jpg";
                                break;
                            case 'mag':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_magadanskay_obl_enl.jpg";
                                break;
                            case 'mos':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_moskovskay_obl_new.jpg";
                                break;
                            case 'mur':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_murmanskay_obl_new.jpg";
                                break;
                            case 'nin':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_nizegorodskay_obl_new.jpg";
                                break;
                            case 'nov':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_novgorodskay_obl_new.jpg";
                                break;
                            case 'nvs':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_novosibirskay_obl_new.jpg";
                                break;
                            case 'oms':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_omskay_obl_new.jpg";
                                break;
                            case 'oren':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_orenburskay_obl_enl.jpg";
                                break;
                            case 'orl':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_orlovskay_obl_enl.jpg";
                                break;
                            case 'pnz':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_penza_region_new.jpg";
                                break;
                            case 'psk':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_pskovskay_obl_new.jpg";
                                break;
                            case 'ros':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_rostovskaya_obl_enl.jpg";
                                break;
                            case 'rya':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_ryazanskaya_obl_enl.jpg";
                                break;
                            case 'sam':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_samarskaya_obl_new.jpg";
                                break;
                            case 'sar':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_saratovskaya_obl_enl_0.jpg";
                                break;
                            case 'sah':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_sahalinskaya_obl_enl.jpg";
                                break;
                            case 'sve':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_sverdlovskaya_obl_new.jpg";
                                break;
                            case 'smo':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_smolenskaya_obl_enl.jpg";
                                break;
                            case 'tam':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_tambovskaya_obl_new.jpg";
                                break;
                            case 'tom':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_tomskaya_obl_enl.jpg";
                                break;
                            case 'tul':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_tulskaya_obl_enl.jpg";
                                break;
                            case 'tyu':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_tumenskaya_obl_enl.jpg";
                                break;
                            case 'tvobl':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_tverskaya_obl_new.jpg";
                                break;
                            case 'uly':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_ulyanovskaya_obl_new.jpg";
                                break;
                            case 'xobl':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_hersonskaia_obl.jpg";
                                break;
                            case 'cheb':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_chelyabinskaya_obl_enl.jpg";
                                break;
                            case 'yar':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_yaroslavskaya_obl_enl.jpg";
                                break;
                            case 'msk':
                                flagSvg = "https://upload.wikimedia.org/wikipedia/commons/thumb/0/03/Flag_of_Moscow%2C_Russia.svg/1280px-Flag_of_Moscow%2C_Russia.svg.png";
                                break;
                            case 'spb':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_st_peterburg.jpg";
                                break;
                            case 'sev':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_sevastopol.jpg";
                                break;
                            case 'evao':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_evrejskaja_ao.jpg";
                                break;
                            case 'nao':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_nenetskiy_avt_okrug_enl.jpg";
                                break;
                            case 'hmao':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_hanty_mansiyskiy_avt_okr1.jpg";
                                break;
                            case 'chao':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_chucotskiy_avt_okr_new.jpg";
                                break;
                            case 'yamalo':
                                flagSvg = "https://www.megaflag.ru/sites/default/files/images/shop/products/flag_jamalo_neneckogo_avt_okr.jpg";
                                break;
                            default:
                                flagSvg = 'https://upload.wikimedia.org/wikipedia/commons/thumb/a/a7/Olympic_flag.svg/330px-Olympic_flag.svg.png'

                        }
                        tooltipFlag.src = flagSvg;

                        const tooltipName = document.createElement('span');
                        tooltipName.className = 'tooltip-name';
                        tooltipName.textContent = player.name;

                        const tooltipScore = document.createElement('span');
                        tooltipScore.className = 'tooltip-score';
                        if (match.score) {
                            const scores = match.score.split('‚Äì');
                            tooltipScore.textContent = `${scores[0]}:${scores[1]}`;
                        }

                        tooltipHeader.appendChild(tooltipFlag);
                        tooltipHeader.appendChild(tooltipName);
                        tooltipHeader.appendChild(tooltipScore);
                        tooltipElement.appendChild(tooltipHeader);

                        // –°—á–µ—Ç –ø–æ —Å–µ—Ç–∞–º
                        if (match.sets) {
                            const tooltipSets = document.createElement('div');
                            tooltipSets.className = 'tooltip-sets';

                            const sets = match.sets.split(',');
                            sets.forEach(set => {
                                const tooltipSet = document.createElement('div');
                                tooltipSet.className = 'tooltip-set';
                                tooltipSet.textContent = set;
                                tooltipSets.appendChild(tooltipSet);
                            });

                            tooltipElement.appendChild(tooltipSets);
                        }

                        // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞—Ç—á–µ
                        if (match.info && (match.info.date || match.info.table || match.info.notes)) {
                            const tooltipInfo = document.createElement('div');
                            tooltipInfo.className = 'tooltip-info';

                            let infoText = '';
                            if (match.info.date) infoText += `üìÖ ${match.info.date} `;
                            if (match.info.table) infoText += `üèì ${match.info.table} `;
                            if (match.info.notes) infoText += `üìù ${match.info.notes}`;

                            tooltipInfo.textContent = infoText.trim();
                            tooltipElement.appendChild(tooltipInfo);
                        }

                        playerElement.appendChild(tooltipElement);

                        // –î–æ–±–∞–≤–ª—è–µ–º –∏–≥—Ä–æ–∫–∞ –≤ –∫–∞—Ä—Ç—É –ø—É—Ç–µ–π
                        if (player.name) {
                            if (!playerPathMap.has(player.name)) {
                                playerPathMap.set(player.name, []);
                            }
                            playerPathMap.get(player.name).push({
                                round: roundIndex,
                                match: matchIndex,
                                playerIndex: playerIndex
                            });
                        }

                        // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ –ø—É—Ç–∏ –∏–≥—Ä–æ–∫–∞
                        playerElement.addEventListener('mouseenter', () => {
                            highlightPlayerPath(player.name);
                        });

                        playerElement.addEventListener('mouseleave', () => {
                            clearHighlightedPaths();
                        });
                    }

                    playerElement.appendChild(flagElement);
                    playerElement.appendChild(nameElement);
                    playerElement.appendChild(scoreElement);
                    matchElement.appendChild(playerElement);
                });

                // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞—Ç—á–µ
                if (match.info && (match.info.date || match.info.table || match.info.notes)) {
                    const infoElement = document.createElement('div');
                    infoElement.className = 'match-info';

                    let infoText = '';
                    if (match.info.date) infoText += `üìÖ ${match.info.date} ` ;
                    if (match.info.table) infoText += `üèì ${match.info.table} `;
                    if (match.info.notes) infoText += `üìù ${match.info.notes}`;
                    else infoText += `üìù ${roundName}`;

                    infoElement.textContent = infoText.trim();
                    matchElement.appendChild(infoElement);
                }else {
                    const infoElement = document.createElement('div');
                    infoElement.className = 'match-info';
                    let infoText = `${roundName}`;
                    infoElement.textContent = infoText.trim();
                    matchElement.appendChild(infoElement);
                }

                // –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
                if (match.winner !== null) {
                    const progressElement = document.createElement('div');
                    progressElement.className = 'progress-indicator';
                    progressElement.style.width = '100%';
                    matchElement.appendChild(progressElement);
                }

                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è —Ä–µ–∂–∏–º–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
                if (isAdminMode) {
                    matchElement.addEventListener('click', () => {
                        openMatchModal(match);
                    });
                }

                roundElement.appendChild(matchElement);
            });

            tournamentBracket.appendChild(roundElement);
        }

        // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
        tournamentBracket.appendChild(connectorWrapper);
        drawConnectors();


        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å–µ–ª–µ–∫—Ç–æ—Ä—ã —Ä–∞—É–Ω–¥–æ–≤
        const startRoundSelect = document.getElementById('startRound');
        const endRoundSelect = document.getElementById('endRound');

        // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–∞—É–Ω–¥—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
        const maxRounds = Math.log2(tournament.playerCount);
        let playerCounts = tournament.playerCount;
        let playerCountsText;
        for (let i = 0; i < startRoundSelect.options.length; i++) {
            playerCounts/=2;
            switch (playerCounts) {
                case 2: {
                    playerCountsText = '1/2 —Ñ–∏–Ω–∞–ª–∞';
                    break;
                }
                case 4: {
                    playerCountsText = '1/4 —Ñ–∏–Ω–∞–ª–∞';
                    break;
                }
                case 8: {
                    playerCountsText = '1/8 —Ñ–∏–Ω–∞–ª–∞';
                    break;
                }
                case 16: {
                    playerCountsText = '1/16 —Ñ–∏–Ω–∞–ª–∞';
                    break;
                }
                case 32: {
                    playerCountsText = '1/32 —Ñ–∏–Ω–∞–ª–∞';
                    break;
                }
                case 64: {
                    playerCountsText = '1/64 —Ñ–∏–Ω–∞–ª–∞';
                    break;
                }
                case 128: {
                    playerCountsText = '1/128 —Ñ–∏–Ω–∞–ª–∞';
                    break;
                }
                default: playerCountsText = `–§–∏–Ω–∞–ª`;
            }
            if(i >= maxRounds){
                startRoundSelect.options[i].disabled = true;
                startRoundSelect.options[i].textContent =' ';
                endRoundSelect.options[i].disabled = true;
                endRoundSelect.options[i].textContent = '';
            }else{
                startRoundSelect.options[i].disabled = false;
                startRoundSelect.options[i].textContent = playerCountsText;
                endRoundSelect.options[i].disabled = false;
                if(playerCountsText === `–§–∏–Ω–∞–ª`){
                    endRoundSelect.options[i].selected = true;
                }
                endRoundSelect.options[i].textContent = playerCountsText;
            }



            // startRoundSelect.options[i].disabled = i < maxRounds;
            // endRoundSelect.options[i].disabled = i <= maxRounds;
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–∑–≤–∞–Ω–∏—è —Ä–∞—É–Ω–¥–∞
    function getRoundName(roundIndex, totalRounds) {
        // –§–∏–Ω–∞–ª –≤—Å–µ–≥–¥–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ä–∞—É–Ω–¥ (roundIndex = 0)
        if (roundIndex === 0) return '–§–∏–Ω–∞–ª';

        // –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ä–∞—É–Ω–¥–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–æ—Ä–º–∞—Ç 1/X —Ñ–∏–Ω–∞–ª–∞
        const denominator = Math.pow(2, roundIndex);

        switch (denominator) {
            case 2: return '1/2 —Ñ–∏–Ω–∞–ª–∞';
            case 4: return '1/4 —Ñ–∏–Ω–∞–ª–∞';
            case 8: return '1/8 —Ñ–∏–Ω–∞–ª–∞';
            case 16: return '1/16 —Ñ–∏–Ω–∞–ª–∞';
            case 32: return '1/32 —Ñ–∏–Ω–∞–ª–∞';
            case 64: return '1/64 —Ñ–∏–Ω–∞–ª–∞';
            case 128: return '1/128 —Ñ–∏–Ω–∞–ª–∞';
            default: return `1/${denominator} —Ñ–∏–Ω–∞–ª–∞`;
        }
    }

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ª–∏–Ω–∏–π
    function drawConnectors() {
        const connectorWrapper = document.querySelector('.connector-wrapper');
        if (!connectorWrapper) return;

        connectorWrapper.innerHTML = '';

        const rounds = document.querySelectorAll('.round');

        // –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞—É–Ω–¥–∞, –∫—Ä–æ–º–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ
        for (let i = 0; i < rounds.length - 1; i++) {
            const currentRound = rounds[i];
            const nextRound = rounds[i + 1];
            const currentMatches = currentRound.querySelectorAll('.match');
            const nextMatches = nextRound.querySelectorAll('.match');

            // –î–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Ç—á–∞ –≤ —Ç–µ–∫—É—â–µ–º —Ä–∞—É–Ω–¥–µ
            for (let j = 0; j < currentMatches.length; j++) {
                const currentMatch = currentMatches[j];
                const nextMatchIndex = Math.floor(j / 2);

                if (nextMatchIndex < nextMatches.length) {
                    const nextMatch = nextMatches[nextMatchIndex];

                    // –ü–æ–ª—É—á–∞–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã
                    const currentRect = currentMatch.getBoundingClientRect();
                    const nextRect = nextMatch.getBoundingClientRect();
                    const wrapperRect = connectorWrapper.getBoundingClientRect();

                    // –°–æ–∑–¥–∞–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É—é –ª–∏–Ω–∏—é
                    const horizontalConnector = document.createElement('div');
                    horizontalConnector.className = 'connector connector-horizontal';
                    horizontalConnector.dataset.from = `${currentRound.dataset.round}-${j}`;
                    horizontalConnector.dataset.to = `${nextRound.dataset.round}-${nextMatchIndex}`;

                    // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É—é –ª–∏–Ω–∏—é
                    const currentMatchCenter = currentRect.top + currentRect.height / 2 - wrapperRect.top;
                    horizontalConnector.style.top = `${currentMatchCenter}px`;
                    horizontalConnector.style.left = `${currentRect.right - wrapperRect.left}px`;
                    horizontalConnector.style.width = `${nextRect.left - currentRect.right}px`;

                    connectorWrapper.appendChild(horizontalConnector);

                    // –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤—ã–π –º–∞—Ç—á –∏–∑ –ø–∞—Ä—ã, —Å–æ–∑–¥–∞–µ–º –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—É—é –ª–∏–Ω–∏—é
                    if (j % 2 === 0) {
                        const verticalConnector = document.createElement('div');
                        verticalConnector.className = 'connector connector-vertical';
                        verticalConnector.dataset.connects = `${nextRound.dataset.round}-${nextMatchIndex}`;

                        const nextMatchCenter = nextRect.top + nextRect.height / 2 - wrapperRect.top;
                        const currentMatchCenter1 = currentRect.top + currentRect.height / 2 - wrapperRect.top;
                        const currentMatchCenter2 = currentMatches[j + 1] ?
                            currentMatches[j + 1].getBoundingClientRect().top +
                            currentMatches[j + 1].getBoundingClientRect().height / 2 - wrapperRect.top :
                            currentMatchCenter1;

                        verticalConnector.style.top = `${Math.min(currentMatchCenter1, currentMatchCenter2)}px`;
                        verticalConnector.style.left = `${nextRect.left - wrapperRect.left - 2}px`;
                        verticalConnector.style.height = `${Math.abs(currentMatchCenter2 - currentMatchCenter1)}px`;

                        connectorWrapper.appendChild(verticalConnector);
                    }
                }
            }
        }
    }


    

    // –§—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ç—á–∞
    function openMatchModal(match) {
        currentEditingMatch = match;


        document.getElementById('player1Name').value = match.players[0].name || '';
        document.getElementById('player1Country').value = match.players[0].country || 'ru';
        document.getElementById('player2Name').value = match.players[1].name || '';
        document.getElementById('player2Country').value = match.players[1].country || 'ru';

        if (match.score) {
            const scores = match.score.split('‚Äì');
            document.getElementById('player1Score').value = scores[0];
            document.getElementById('player2Score').value = scores[1];
        } else {
            document.getElementById('player1Score').value = '';
            document.getElementById('player2Score').value = '';
        }

        document.getElementById('setSets').value = match.sets || '';
        document.getElementById('matchWinner').value = match.winner === 0 ? 'player1' : match.winner === 1 ? 'player2' : '';
        document.getElementById('matchDate').value = match.info?.date || '';
        document.getElementById('tableNumber').value = match.info?.table || '';
        document.getElementById('matchNotes').value = match.info?.notes || ``;

        matchModal.classList.remove('hidden');
        matchModal.classList.add('flex');
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞ –¥–ª—è –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏ —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ª–∏–Ω–∏–π
    window.addEventListener('resize', () => {
        if (tournaments.length > 0) {
            drawConnectors();
        }
    });

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    window.addEventListener('DOMContentLoaded', () => {
        loadTournamentBtn.click()

        currentTournamentIndex = tournaments.length-1;
        updateTournamentTabs();
        renderTournament(tournaments[currentTournamentIndex]);

    });
</script>



</body>
</html>